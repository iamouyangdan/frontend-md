import { _ as _export_sfc, r as resolveComponent, o as openBlock, c as createElementBlock, a as createBaseVNode, b as createVNode, F as Fragment, d as createTextVNode, e as createStaticVNode } from "./app.050d295a.js";
var _imports_0 = "/frontend-md/images/\u7F16\u7801\u89C4\u8303/image1.png";
var _imports_1 = "/frontend-md/images/\u7F16\u7801\u89C4\u8303/image2.png";
var _imports_2 = "/frontend-md/images/\u7F16\u7801\u89C4\u8303/image3.png";
var _imports_3 = "/frontend-md/images/\u7F16\u7801\u89C4\u8303/image4.png";
var _imports_4 = "/frontend-md/images/\u7F16\u7801\u89C4\u8303/image5.png";
var _imports_5 = "/frontend-md/images/\u7F16\u7801\u89C4\u8303/image6.png";
var _imports_6 = "/frontend-md/images/\u7F16\u7801\u89C4\u8303/image7.png";
var _imports_7 = "/frontend-md/images/\u7F16\u7801\u89C4\u8303/image8.png";
var _imports_8 = "/frontend-md/images/\u7F16\u7801\u89C4\u8303/image9.png";
var _imports_9 = "/frontend-md/images/\u7F16\u7801\u89C4\u8303/image10.png";
var _imports_10 = "/frontend-md/images/\u7F16\u7801\u89C4\u8303/image11.png";
const _sfc_main = {};
const _hoisted_1 = /* @__PURE__ */ createBaseVNode("h1", {
  id: "nodejs\u6846\u67B6\u6587\u6863",
  tabindex: "-1"
}, [
  /* @__PURE__ */ createBaseVNode("a", {
    class: "header-anchor",
    href: "#nodejs\u6846\u67B6\u6587\u6863",
    "aria-hidden": "true"
  }, "#"),
  /* @__PURE__ */ createTextVNode(" nodejs\u6846\u67B6\u6587\u6863")
], -1);
const _hoisted_2 = /* @__PURE__ */ createTextVNode("eggjs\u6587\u6863\uFF1A");
const _hoisted_3 = {
  href: "https://www.eggjs.org/zh-CN",
  target: "_blank",
  rel: "noopener noreferrer"
};
const _hoisted_4 = /* @__PURE__ */ createBaseVNode("strong", null, "https://www.eggjs.org/zh-CN", -1);
const _hoisted_5 = /* @__PURE__ */ createTextVNode("\u6846\u67B6\u4EE3\u7801\u5730\u5740\uFF1A");
const _hoisted_6 = {
  href: "https://codeup.aliyun.com/5f009f6e6a575d7f23661045/frontend/nodejs-frame",
  target: "_blank",
  rel: "noopener noreferrer"
};
const _hoisted_7 = /* @__PURE__ */ createBaseVNode("strong", null, "https://codeup.aliyun.com/5f009f6e6a575d7f23661045/frontend/nodejs-frame", -1);
const _hoisted_8 = /* @__PURE__ */ createStaticVNode('<h2 id="_1\u3001\u4EE3\u7801\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#_1\u3001\u4EE3\u7801\u7ED3\u6784" aria-hidden="true">#</a> 1\u3001\u4EE3\u7801\u7ED3\u6784</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\n\u251C\u2500\u2500 app\n\u2502   \u251C\u2500\u2500 router.js  \u8DEF\u7531\u5165\u53E3, \u914D\u7F6E\u63A5\u53E3\u5730\u5740\u8BF7\u6C42\u7684\u5730\u5740,\u8BF7\u6C42\u65B9\u5F0F,\u5BF9\u5E94\u7684controller\n\u2502   \u251C\u2500\u2500 controller  \u63A7\u5236\u5668\n\u2502   \u2502   \u251C\u2500\u2500 ms  \u7ED9\u5176\u4ED6\u5FAE\u670D\u52A1\u8C03\u7528\u7684\u63A5\u53E3, \u53EA\u63D0\u4F9B\u7ED9\u5185\u90E8\u8C03\u7528\n\u2502   \u2502   \u251C\u2500\u2500 webapi  \u7ED9\u524D\u7AEF\u8C03\u7528\u7684\u4E1A\u52A1\u63A5\u53E3\n\u2502   \u2502   \u2514\u2500\u2500 callbackController.js  \u76D1\u542C\u670D\u52A1\u56DE\u8C03\n\u2502   \u251C\u2500\u2500 core  \u6838\u5FC3\u65B9\u6CD5\n\u2502   \u2502   \u2502\u2500\u2500 baseController  \u57FA\u7840controller\n\u2502   \u2502   \u2502\u2500\u2500 baseService  \u57FA\u7840service\n\u2502   \u2502   \u2514\u2500\u2500 callbackHandler  \u76D1\u542C\u4EE5\u53CA\u53D1\u9001\u901A\u77E5\u7684\u65B9\u6CD5\n\u2502   \u251C\u2500\u2500 service  \u670D\u52A1\n\u2502   \u2502   \u2514\u2500\u2500 xxx.js\n\u2502   \u251C\u2500\u2500 middleware  \u4E2D\u95F4\u4EF6\n\u2502   \u2502   \u2514\u2500\u2500 commonHandler.js  \u7EDF\u4E00\u5168\u5C40\u4E2D\u95F4\u4EF6\n\u2502   \u251C\u2500\u2500 utils\n\u2502   \u2502   \u251C\u2500\u2500 common.js  \u516C\u7528\u65B9\u6CD5\n\u2502   \u2502   \u251C\u2500\u2500 pinyin.js  \u4E2D\u6587\u8F6C\u62FC\u97F3\u65B9\u6CD5\n\u2502   \u2502   \u2514\u2500\u2500 snowflakeId.js  \u96EA\u82B1id\u751F\u6210\u5668\n\u2502   \u2514\u2500\u2500 extend\n\u2502       \u2514\u2500\u2500 helper.js  \u516C\u7528\u65B9\u6CD5\n\u251C\u2500\u2500 config  \u63D2\u4EF6\u914D\u7F6E\u4EE5\u53CA\u5404\u4E2A\u73AF\u5883\u7684\u53C2\u6570\u914D\u7F6E\n\u2502   \u251C\u2500\u2500 plugin.js  \u63D2\u4EF6\u914D\u7F6E\n\u2502   \u251C\u2500\u2500 config.default.js\n\u2502   \u251C\u2500\u2500 config.prod.js  \u751F\u4EA7\u73AF\u5883\u914D\u7F6E(\u5305\u62ECmysql\u3001orm\u6846\u67B6egg\u2500sequelize\u914D\u7F6E\u3001redis\u914D\u7F6E\u3001\u5FAE\u670D\u52A1nacos\u914D\u7F6E\u3001\u65E5\u5FD7\u6253\u5370\u914D\u7F6E\u7B49)\n\u2502   \u251C\u2500\u2500 config.dev.js  \u6D4B\u8BD5\u73AF\u5883\u914D\u7F6E\n\u2502   \u2514\u2500\u2500 config.local.js  \u672C\u5730\u5F00\u53D1\u73AF\u5883\u914D\u7F6E\n\u251C\u2500\u2500 database\n\u251C\u2500\u2500 logs\n\u251C\u2500\u2500 scripts\n\u251C\u2500\u2500 shell  \u53D1\u5E03\u811A\u672C\n\u251C\u2500\u2500 test  \u5355\u5143\u6D4B\u8BD5, \u6587\u6863: https://www.eggjs.org/zh\u2500CN/core/development#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95\n\u251C\u2500\u2500 .eslintignore  eslint\u5FFD\u7565\u6587\u4EF6\n\u251C\u2500\u2500 .eslintrc  eslint\u914D\u7F6E\u6587\u4EF6\n\u251C\u2500\u2500 .sequelizerc  sequelizerc\u7684\u914D\u7F6E\u6587\u4EF6\n\u251C\u2500\u2500 app.js  \u7528\u4E8E\u81EA\u5B9A\u4E49\u542F\u52A8\u65F6\u7684\u521D\u59CB\u5316\u5DE5\u4F5C\n\u2514\u2500\u2500 package.json  \u9879\u76EE\u4F9D\u8D56,\u542F\u52A8\u811A\u672C\u914D\u7F6E\n\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p><img src="' + _imports_0 + '" alt=""></p><h2 id="_2\u3001\u914D\u7F6E\u4FE1\u606F" tabindex="-1"><a class="header-anchor" href="#_2\u3001\u914D\u7F6E\u4FE1\u606F" aria-hidden="true">#</a> 2\u3001\u914D\u7F6E\u4FE1\u606F</h2><p>\u4EE5 config/config.local.js \u4E3A\u4F8B</p><h2 id="_1-mysql-\u548C-redis-\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_1-mysql-\u548C-redis-\u914D\u7F6E" aria-hidden="true">#</a> \uFF081\uFF09mysql \u548C redis \u914D\u7F6E</h2><p><img src="' + _imports_1 + '" alt=""></p><h3 id="mysql" tabindex="-1"><a class="header-anchor" href="#mysql" aria-hidden="true">#</a> MySQL</h3><p>\u6570\u636E\u5E93\u4F7F\u7528\u7684\u662FMySQL\uFF0C\u8FD9\u91CC\u4E0D\u76F4\u63A5\u8FDE\u63A5\u6570\u636E\u5E93\uFF0C\u800C\u662F\u901A\u8FC7orm\u6846\u67B6 egg-sequelize \u6765\u8FDE\u63A5\u6570\u636E\u5E93\u3002 \u4F7F\u7528\u8BE5\u6846\u67B6\u53EF\u4EE5\u4F7F\u6570\u636E\u5E93\u64CD\u4F5C\u66F4\u7B80\u5355\u3002\u5404\u9879\u914D\u7F6E\u4FE1\u606F\u5982\u4E0B\uFF1A</p><p>\u2460\u9700\u8981\u5728 config/plugin.js \u4E2D\u914D\u7F6E\u63D2\u4EF6\u4FE1\u606F</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\nmodule.exports = {\n\n  ...\n  sequelize: {\n    enable: true,\n    package: &#39;egg-sequelize&#39;,\n  }\n  ...\n}\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><img src="' + _imports_2 + '" alt=""></p><p>\u2461\u5728 config/config.local.js \u4E2D\u914D\u7F6E\u5982\u4E0B:</p><p><img src="' + _imports_3 + '" alt=""></p>', 14);
const _hoisted_22 = /* @__PURE__ */ createTextVNode("\u6587\u6863\uFF1A");
const _hoisted_23 = {
  href: "https://www.eggjs.org/zh-CN/tutorials/sequelize",
  target: "_blank",
  rel: "noopener noreferrer"
};
const _hoisted_24 = /* @__PURE__ */ createBaseVNode("strong", null, "https://www.eggjs.org/zh-CN/tutorials/sequelize", -1);
const _hoisted_25 = /* @__PURE__ */ createStaticVNode('<h3 id="redis" tabindex="-1"><a class="header-anchor" href="#redis" aria-hidden="true">#</a> Redis</h3><p>\u2460\u9700\u8981\u5728 config/plugin.js \u4E2D\u914D\u7F6E\u63D2\u4EF6\u4FE1\u606F</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\nmodule.exports = {\n\n  ...\n  redis: {\n    enable: true,\n    package: &#39;egg-redis&#39;,\n  }\n  ...\n}\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>\u2461\u5728 config/config.local.js \u4E2D\u914D\u7F6E\u5982\u4E0B:</p><p><img src="' + _imports_4 + '" alt=""></p><h2 id="_2-\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_2-\u65E5\u5FD7" aria-hidden="true">#</a> \uFF082\uFF09\u65E5\u5FD7</h2><p>\u65E5\u5FD7\u914D\u7F6E\u5982\u4E0B\uFF0C\u5176\u4E2D logPath \u4E3A\u65E5\u5FD7\u7684\u5B58\u653E\u8DEF\u5F84\u3002\u76EE\u524D\u751F\u4EA7\u73AF\u5883\u8BBE\u7F6E\u4E3A <code>/data/logs/nodejs</code> \u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token operator">...</span>\n\n  config<span class="token punctuation">.</span>logger <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">dir</span><span class="token operator">:</span> logPath<span class="token punctuation">,</span>\n    <span class="token function">formatter</span><span class="token punctuation">(</span><span class="token parameter">meta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>meta<span class="token punctuation">.</span>message<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        meta<span class="token punctuation">.</span>message <span class="token operator">=</span> meta<span class="token punctuation">.</span>message<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;...&#39;</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>meta<span class="token punctuation">.</span>date<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">  </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>meta<span class="token punctuation">.</span>level<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>meta<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token comment">// ctx logger</span>\n    <span class="token function">contextFormatter</span><span class="token punctuation">(</span><span class="token parameter">meta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>meta<span class="token punctuation">.</span>message<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        meta<span class="token punctuation">.</span>message <span class="token operator">=</span> meta<span class="token punctuation">.</span>message<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;...&#39;</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>meta<span class="token punctuation">.</span>date<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">  </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>meta<span class="token punctuation">.</span>level<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> - [</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>meta<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>header<span class="token punctuation">[</span><span class="token string">&#39;x-request-id&#39;</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">&#39;-&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">] : </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>meta<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  <span class="token operator">...</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><code>formatter</code>\u4E0E <code>contextFormatter</code> \u65B9\u6CD5\u914D\u7F6E\u65E5\u5FD7\u683C\u5F0F\u5316\uFF0C\u4E00\u822C\u60C5\u51B5\u4E0B\u65E0\u9700\u66F4\u6539\u3002\u9ED8\u8BA4\u65E5\u5FD7\u683C\u5F0F\u4E3A\uFF1A</p><blockquote><p>\u65E5\u671F \u65E5\u5FD7\u7B49\u7EA7 - [\u8BF7\u6C42id] [\u6587\u4EF6\u540D] \u65E5\u5FD7\u5185\u5BB9</p></blockquote><blockquote><p>\u65E5\u671F \u65E5\u5FD7\u7B49\u7EA7 - [\u8BF7\u6C42id] [\u6587\u4EF6\u540D] \u63A5\u53E3\u5730\u5740 \u63A5\u53E3\u8BF7\u6C42\u53C2\u6570</p></blockquote><p><strong>\u90E8\u5206\u65E5\u5FD7\u5185\u5BB9:</strong></p><p><img src="' + _imports_5 + '" alt=""></p><p><strong>\u65E5\u5FD7\u6253\u5370\uFF1A</strong></p><p>\u914D\u7F6E\u597D\u4E4B\u540E\u53EF\u4EE5\u5728 Controller \u548C Service \u91CC\u9762\u4F7F\u7528 <code>logger</code>\u3001<code>app.logger</code>\u3001<code>ctx.logger</code>\u6253\u5370\u65E5\u5FD7</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>ctx<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&#39;debug info&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nctx<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;some request data: %j&#39;</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>\nctx<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&#39;WARNNING!!!!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// \u9519\u8BEF\u65E5\u5FD7\u8BB0\u5F55\uFF0C\u76F4\u63A5\u4F1A\u5C06\u9519\u8BEF\u65E5\u5FD7\u5B8C\u6574\u5806\u6808\u4FE1\u606F\u8BB0\u5F55\u4E0B\u6765\uFF0C\u5E76\u4E14\u8F93\u51FA\u5230 errorLog \u4E2D</span>\n<span class="token comment">// \u4E3A\u4E86\u4FDD\u8BC1\u5F02\u5E38\u53EF\u8FFD\u8E2A\uFF0C\u5FC5\u987B\u4FDD\u8BC1\u6240\u6709\u629B\u51FA\u7684\u5F02\u5E38\u90FD\u662F Error \u7C7B\u578B\uFF0C\u56E0\u4E3A\u53EA\u6709 Error \u7C7B\u578B\u624D\u4F1A\u5E26\u4E0A\u5806\u6808\u4FE1\u606F\uFF0C\u5B9A\u4F4D\u5230\u95EE\u9898\u3002</span>\nctx<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;whoops&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_3-\u5FAE\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_3-\u5FAE\u670D\u52A1" aria-hidden="true">#</a> \uFF083\uFF09\u5FAE\u670D\u52A1</h2><p>\u4F7F\u7528 <code>eggjs-nacos</code> \u63D2\u4EF6</p><p>\u2460\u9700\u8981\u5728 config/plugin.js \u4E2D\u914D\u7F6E\u63D2\u4EF6\u4FE1\u606F</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>module.exports = {\n\n  ...\n  nacos: {\n    enable: true,\n    env: [ &#39;dev&#39;, &#39;prod&#39; ],\n    package: &#39;eggjs-nacos&#39;,\n  }\n  ...\n}\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>\u2461\u5728 config/config.local.js \u4E2D\u914D\u7F6E\u5982\u4E0B:</p><p><img src="' + _imports_6 + '" alt=""></p>', 22);
const _hoisted_47 = /* @__PURE__ */ createTextVNode("\u6587\u6863\u5730\u5740\uFF1A");
const _hoisted_48 = {
  href: "https://github.com/1981430140/eggjs-nacos",
  target: "_blank",
  rel: "noopener noreferrer"
};
const _hoisted_49 = /* @__PURE__ */ createBaseVNode("strong", null, "https://github.com/1981430140/eggjs-nacos", -1);
const _hoisted_50 = /* @__PURE__ */ createStaticVNode('<p>\u65E0\u9700\u4F7F\u7528\u5FAE\u670D\u52A1\u5219\u65E0\u9700\u6DFB\u52A0\u6B64\u914D\u7F6E\u3002</p><h2 id="_3\u3001\u6570\u636E\u5E93" tabindex="-1"><a class="header-anchor" href="#_3\u3001\u6570\u636E\u5E93" aria-hidden="true">#</a> 3\u3001\u6570\u636E\u5E93</h2><p><strong>\u793A\u4F8B\u6570\u636E\u5E93\u6587\u4EF6\u5728 sql \u76EE\u5F55\u4E2D\uFF0C\u53EF\u4EE5\u5BFC\u5165\u5230\u672C\u5730\u6570\u636E\u5E93\u4F7F\u7528\u3002</strong></p><p>\u4F7F\u7528 sequelize \u6765\u8BBF\u95EE\u6570\u636E\u5E93\u3002</p><h2 id="_1-\u521D\u59CB\u5316\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_1-\u521D\u59CB\u5316\u914D\u7F6E" aria-hidden="true">#</a> \uFF081\uFF09\u521D\u59CB\u5316\u914D\u7F6E</h2><p>\u2460 \u5728\u9879\u76EE\u6839\u76EE\u5F55\u521B\u5EFA\u4E00\u4E2A .sequelizerc \u6587\u4EF6\uFF0C\u6307\u5B9A\u5404\u9879\u914D\u7F6E\u8BFB\u53D6\u8DEF\u5F84</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token literal-property property">config</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;database/config.json&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token string-property property">&#39;migrations-path&#39;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;database/migrations&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token string-property property">&#39;seeders-path&#39;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;database/seeders&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token string-property property">&#39;models-path&#39;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;app/model&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>\u2461 \u914D\u7F6E config/plugin.js \u4EE5\u53CA config/config.local.js</p><p>\u4EE5\u4E0A\u7B2C\u4E8C\u70B9\u5DF2\u7ECF\u63D0\u53CA\uFF0C\u4E0D\u518D\u8D58\u8FF0\u3002</p><p>\u2462 \u914D\u7F6E \u6570\u636E\u5E93model\u76F8\u5173\u5185\u5BB9</p><p>\u6B64\u9879\u76EE\u4F7F\u7528 <code>sequelize-auto</code>\u63D2\u4EF6\u6839\u636E\u8FDE\u63A5\u7684\u6570\u636E\u5E93\u81EA\u52A8\u751F\u6210model\u3002\u81EA\u52A8\u751F\u6210\u7684\u811A\u672C\u662F\u6839\u76EE\u5F55\u4E0B\u7684<code>script/autoModels.js</code>\u6B64\u811A\u672C\u5728 package.json \u4E2D\u914D\u7F6E\u4E86\u524D\u7AEF\u5B89\u88C5\u4F9D\u8D56\u540E\u4F1A\u81EA\u52A8\u89E6\u53D1\u6B64\u811A\u672C</p><p><strong>autoModels.js</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&#39;use strict&#39;;\n\nconst SequelizeAuto = require(&#39;sequelize-auto&#39;);\nconst config = require(&#39;../config/config.local.js&#39;)({ name: &#39;&#39; });\n\nconst db = {\n  database: config.sequelize.database,\n  host: config.sequelize.host,\n  port: config.sequelize.port,\n  username: config.sequelize.username,\n  password: config.sequelize.password,\n  dialect: config.sequelize.dialect,\n};\nconst auto = new SequelizeAuto(db.database, db.username, db.password, {\n  host: db.host,\n  dialect: db.dialect,\n  directory: &#39;./database/model/&#39;, // prevents the program from writing to disk\n  port: db.port,\n  additional: {\n    timestamps: false,\n  },\n  // tables: []  // \u6307\u5B9A\u8868\u683C\n  // ...\n});\n\nauto.run(function(err) {\n  if (err) throw err;\n});\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h2 id="_2-\u521D\u59CBmodel" tabindex="-1"><a class="header-anchor" href="#_2-\u521D\u59CBmodel" aria-hidden="true">#</a> \uFF082\uFF09\u521D\u59CBmodel</h2><p>sequelize \u662F\u901A\u8FC7\u4E00\u4E2A\u4E00\u4E2A\u4E0E\u6570\u636E\u5E93\u5BF9\u5E94\u7684model\uFF0C\u6765\u8BBF\u95EE\u6570\u636E\u5E93\u7684\u3002\u6211\u4EEC\u9700\u8981\u5148\u7F16\u5199 model \u624D\u80FD\u901A\u8FC7 model \u8BBF\u95EE\u6570\u636E\u5E93\u3002</p><p>\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7 nodejs \u7684 fs \u6A21\u5757\u8BFB\u53D6 database/model \u6765\u81EA\u52A8\u751F\u6210 model \u6587\u4EF6\u3002\u5177\u4F53\u4EE3\u7801\u5728 <code>script/init.js</code></p><h2 id="_3-\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#_3-\u4F7F\u7528" aria-hidden="true">#</a> \uFF083\uFF09\u4F7F\u7528</h2><p>\u914D\u7F6E\u597D Model \u540E\u5C31\u53EF\u4EE5\u5728Controller \u548C Service \u4E2D\u901A\u8FC7 <code>app.model.Model\u540D</code> \u6216\u8005 <code>ctx.model.Model\u540D</code> \u8BBF\u95EE\u5230\u4E86\u3002\u53EF\u4EE5\u901A\u8FC7\u8FD9\u4E2Amodel \u8FDB\u884C\u6570\u636E\u5E93\u64CD\u4F5C\u3002</p><p>\u5B98\u7F51\u4F8B\u5B50\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> Controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;egg&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controller<span class="token punctuation">;</span>\n\n<span class="token keyword">function</span> <span class="token function">toInt</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> str <span class="token operator">===</span> <span class="token string">&#39;number&#39;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> str<span class="token punctuation">;</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>str<span class="token punctuation">)</span> <span class="token keyword">return</span> str<span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>\n  <span class="token keyword">async</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">;</span>\n    <span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token punctuation">{</span>\n      <span class="token literal-property property">limit</span><span class="token operator">:</span> <span class="token function">toInt</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>query<span class="token punctuation">.</span>limit<span class="token punctuation">)</span><span class="token punctuation">,</span>\n      <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token function">toInt</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>query<span class="token punctuation">.</span>offset<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span>User<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">async</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">;</span>\n    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span>User<span class="token punctuation">.</span><span class="token function">findByPk</span><span class="token punctuation">(</span><span class="token function">toInt</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">;</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>\n    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span>User<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">201</span><span class="token punctuation">;</span>\n    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> user<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">async</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">;</span>\n    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">toInt</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span>User<span class="token punctuation">.</span><span class="token function">findByPk</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">404</span><span class="token punctuation">;</span>\n      <span class="token keyword">return</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>\n    <span class="token keyword">await</span> user<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> user<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">async</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">;</span>\n    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">toInt</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span>User<span class="token punctuation">.</span><span class="token function">findByPk</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">404</span><span class="token punctuation">;</span>\n      <span class="token keyword">return</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">await</span> user<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> UserController<span class="token punctuation">;</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br></div></div>', 20);
const _hoisted_70 = /* @__PURE__ */ createTextVNode("\u6587\u6863\uFF1A");
const _hoisted_71 = {
  href: "https://www.eggjs.org/zh-CN/tutorials/sequelize",
  target: "_blank",
  rel: "noopener noreferrer"
};
const _hoisted_72 = /* @__PURE__ */ createBaseVNode("strong", null, "https://www.eggjs.org/zh-CN/tutorials/sequelize", -1);
const _hoisted_73 = /* @__PURE__ */ createStaticVNode('<h2 id="_4-\u591A\u8868\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_4-\u591A\u8868\u67E5\u8BE2" aria-hidden="true">#</a> \uFF084\uFF09\u591A\u8868\u67E5\u8BE2</h2><p>\u5728\u6211\u4EEC\u5B9E\u9645\u4F7F\u7528\u4E2D\uFF0C\u6570\u636E\u53EF\u80FD\u5B58\u5728\u591A\u4E2A\u8868\u4E2D\uFF0C\u8FD9\u65F6\u6211\u4EEC\u67E5\u8BE2\u6570\u636E\u65F6\u9700\u8981\u5173\u8054\u591A\u4E2A\u8868\u3002\u4F8B\u5982\uFF1A\u6709<code>A</code>\u548C<code>B</code>\u4E24\u4E2A\u6A21\u578B\uFF0C\u4E14A \u5BF9 B\u662F\u4E00\u5BF9\u591A\u7684\u5173\u7CFB\u3002\u9700\u6C42\u662F\uFF1A\u67E5\u8BE2\u51FAA\u5E76\u4E14\u5217\u51FA\u4E0EA\u76F8\u5173\u7684\u6240\u6709B</p><h3 id="_1-\u5173\u8054-a-\u548C-b-\u4E24\u4E2Amodel" tabindex="-1"><a class="header-anchor" href="#_1-\u5173\u8054-a-\u548C-b-\u4E24\u4E2Amodel" aria-hidden="true">#</a> \uFF081\uFF09\u5173\u8054 A \u548C B \u4E24\u4E2Amodel</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u5047\u8BBE B \u8868\u4E2D, a_id\u5B57\u6BB5\u4E0E A\u8868\u7684id \u5B57\u6BB5\u5173\u8054</span>\n<span class="token keyword">const</span> AModel <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> BModel <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token constant">B</span><span class="token punctuation">;</span>\nAModel<span class="token punctuation">.</span><span class="token function">hasMany</span><span class="token punctuation">(</span>BModel<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n  <span class="token literal-property property">sourceKey</span><span class="token operator">:</span> <span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">foreignKey</span><span class="token operator">:</span> <span class="token string">&#39;a_id&#39;</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div>', 4);
const _hoisted_77 = /* @__PURE__ */ createBaseVNode("strong", null, "sequelize\u5173\u8054", -1);
const _hoisted_78 = /* @__PURE__ */ createTextVNode("\uFF1A");
const _hoisted_79 = {
  href: "https://www.sequelize.com.cn/core-concepts/assocs",
  target: "_blank",
  rel: "noopener noreferrer"
};
const _hoisted_80 = /* @__PURE__ */ createBaseVNode("strong", null, "https://www.sequelize.com.cn/core-concepts/assocs", -1);
const _hoisted_81 = /* @__PURE__ */ createStaticVNode('<p>model \u7684\u5173\u8054\u53EA\u9700\u8981\u5173\u8054\u4E00\u6B21\uFF0C \u65E0\u9700\u6BCF\u6B21\u67E5\u8BE2\u90FD\u8FDB\u884C\u5173\u8054\uFF0C \u6240\u4EE5\u628A\u5173\u8054\u7EDF\u4E00\u5728 app/core/associateModel.js \u4E2D\u5199\u5173\u8054\u7684\u5904\u7406\u903B\u8F91\u3002\u5E76\u5728 app.js \u4E2D\u8FDB\u884C\u521D\u59CB\u5316\u3002</p><p><img src="' + _imports_7 + '" alt=""></p><p><img src="' + _imports_8 + '" alt=""></p><h3 id="_2-\u4F7F\u7528-include-\u53C2\u6570\u67E5\u8BE2" tabindex="-1"><a class="header-anchor" href="#_2-\u4F7F\u7528-include-\u53C2\u6570\u67E5\u8BE2" aria-hidden="true">#</a> \uFF082\uFF09\u4F7F\u7528 include \u53C2\u6570\u67E5\u8BE2</h3><p>\u67E5\u8BE2\u65F6\uFF0C\u5BF9A\u8FDB\u884C\u67E5\u8BE2\uFF0C \u7136\u540Einclude\u53C2\u6570\u5305\u542B B\u6A21\u578B</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">.</span><span class="token function">findAndCountAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">del_flag</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// \u67E5\u8BE2\u8003\u6838\u8BA1\u5212</span>\n  <span class="token literal-property property">include</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token constant">B</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">limit</span><span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size<span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_4\u3001\u5FAE\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_4\u3001\u5FAE\u670D\u52A1" aria-hidden="true">#</a> 4\u3001\u5FAE\u670D\u52A1</h2><h2 id="_1-\u914D\u7F6E\u6CE8\u518C\u5FAE\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_1-\u914D\u7F6E\u6CE8\u518C\u5FAE\u670D\u52A1" aria-hidden="true">#</a> \uFF081\uFF09\u914D\u7F6E\u6CE8\u518C\u5FAE\u670D\u52A1</h2><p>\u4EE5\u4E0A\u7B2C\u4E8C\u70B9\u4E2D\u6709\u63CF\u8FF0\u5FAE\u670D\u52A1\u7684\u914D\u7F6E</p><p>**\u8BF4\u660E\uFF1A**\u672C\u5730\u670D\u52A1\u901A\u8FC7 nacos \u6CE8\u518C\u5FAE\u670D\u52A1\u540E, \u53EF\u80FD\u4F1A\u5BFC\u81F4\u7EBF\u4E0A\u670D\u52A1\u8C03\u7528\u5230\u672C\u5730\u6B63\u5728\u5F00\u53D1\u4E2D\u7684\u670D\u52A1\u3002 \u6240\u4EE5\u672C\u5730\u73AF\u5883\u4E0D\u6CE8\u518C\u5FAE\u670D\u52A1\uFF0C\u76F4\u63A5\u901A\u8FC7curl\u8C03\u7528\u5176\u4ED6\u7B2C\u4E09\u65B9\u670D\u52A1\uFF0C\u53EF\u4EE5\u914D\u7F6E\u76F4\u63A5\u8C03\u7528\u67D0\u4E2A\u57DF\u540D</p><p>\u672C\u5730\u73AF\u5883\u914D\u7F6E\uFF1A</p><p>config.local.js</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">appInfo</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n  config<span class="token punctuation">.</span>nacos <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token comment">// \u5FAE\u670D\u52A1\u540D: \u57DF\u540D, </span>\n    <span class="token string-property property">&#39;platform-user-center-ms&#39;</span><span class="token operator">:</span> <span class="token string">&#39;http://50100.ms.product.kapboo.com:8888&#39;</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>plugin.js</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&#39;use strict&#39;;\n\nmodule.exports = {\n  ...\n  nacos: {\n    enable: true,\n    env: [ &#39;dev&#39;, &#39;prod&#39; ],\n    package: &#39;eggjs-nacos&#39;,\n  },\n  ...\n};\n\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_2-\u8C03\u7528\u5FAE\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_2-\u8C03\u7528\u5FAE\u670D\u52A1" aria-hidden="true">#</a> \uFF082\uFF09\u8C03\u7528\u5FAE\u670D\u52A1</h2><p>\u6211\u4EEC\u5DF2\u7ECF\u5728 config.nacos \u4E2D\u7684 subscribers \u914D\u7F6E\u58F0\u660E\u4E86\u6211\u4EEC\u9700\u8981\u8C03\u7528\u7684\u5176\u4ED6\u5FAE\u670D\u52A1\u3002\u6211\u4EEC\u53EF\u4EE5\u5728Controller \u548C Service \u4E2D\u4F7F\u7528 <code>ctx.nacos[&#39;\u5FAE\u670D\u52A1\u522B\u540D&#39;].request(url)</code> \u8C03\u7528\u8BE5\u5FAE\u670D\u52A1\uFF0C\u6B64\u65B9\u6CD5\u5DF2\u7ECF\u5C01\u88C5\u5728 baseService \u91CC\u9762\u53EF\u4EE5\u8FD9\u6837\u8C03\u7528<code>nacos(&#39;\u5FAE\u670D\u52A1\u540D&#39;, url, options)</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">appInfo</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n  config<span class="token punctuation">.</span>nacos <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token operator">...</span>\n    <span class="token literal-property property">subscribers</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token string-property property">&#39;platform-user-center-ms&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token literal-property property">serviceName</span><span class="token operator">:</span> <span class="token string">&#39;platform-user-center-ms&#39;</span><span class="token punctuation">,</span> <span class="token comment">// \u670D\u52A1\u540D\u79F0</span>\n        <span class="token literal-property property">groupName</span><span class="token operator">:</span> <span class="token string">&#39;DEFAULT_GROUP&#39;</span><span class="token punctuation">,</span> <span class="token comment">// \u9ED8\u8BA4 DEFAULT_GROUP</span>\n        <span class="token literal-property property">clusters</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token comment">// \u9ED8\u8BA4 DEFAULT</span>\n        <span class="token literal-property property">subscribe</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// \u662F\u5426\u8BA2\u9605\u670D\u52A1  \u9ED8\u8BA4 true</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token operator">...</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>\u4F8B\u5982\u4EE5\u4E0A\u6211\u4EEC\u914D\u7F6E\u8BA2\u9605\u4E86\u5FAE\u670D\u52A1 platform-user-center-ms\uFF0C\u8C03\u7528\u5FAE\u670D\u52A1\u63D0\u4F9B\u7684\u201C\u7528\u6237\u767B\u5F55\u65E5\u5FD7\u201D\u63A5\u53E3\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> Service <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../core/baseService&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MeasureService</span> <span class="token keyword">extends</span> <span class="token class-name">Service</span> <span class="token punctuation">{</span>\n  <span class="token keyword">async</span> <span class="token function">fetchOtherService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">nacos</span><span class="token punctuation">(</span><span class="token string">&#39;platform-user-center-ms&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;/api/platform-user-center/platform/v1/user/login-log/list&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n      <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>\n      <span class="token literal-property property">dataType</span><span class="token operator">:</span> <span class="token string">&#39;json&#39;</span><span class="token punctuation">,</span>\n      <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token string-property property">&#39;Content-Type&#39;</span><span class="token operator">:</span> <span class="token string">&#39;application/json&#39;</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">const</span> data <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;\u7B2C\u4E09\u65B9\u670D\u52A1\u8FD4\u56DE\u7684\u6570\u636E&#39;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>code <span class="token operator">!==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> data<span class="token punctuation">.</span>object<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> MeasureService<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="_5\u3001\u5982\u4F55\u7F16\u5199\u4E00\u4E2A\u63A5\u53E3" tabindex="-1"><a class="header-anchor" href="#_5\u3001\u5982\u4F55\u7F16\u5199\u4E00\u4E2A\u63A5\u53E3" aria-hidden="true">#</a> 5\u3001\u5982\u4F55\u7F16\u5199\u4E00\u4E2A\u63A5\u53E3</h2><h2 id="_1-\u7F16\u5199-controller" tabindex="-1"><a class="header-anchor" href="#_1-\u7F16\u5199-controller" aria-hidden="true">#</a> \uFF081\uFF09\u7F16\u5199 Controller</h2><p>\u6839\u636E\u63A5\u53E3\u7684\u529F\u80FD\u3001\u6A21\u5757\u65B0\u5EFAController\uFF0C\uFF08\u63A5\u53E3\u63D0\u4F9B\u7ED9\u5FAE\u670D\u52A1\u5185\u90E8\u8C03\u7528\u5219\u653E\u5728 app/controller/ms\uFF0C\u63D0\u4F9B\u7ED9\u524D\u7AEF\u8C03\u7528\u7684\u63A5\u53E3\u653E\u5728 app/controller/weiapi\uFF09\uFF0C\u4F8B\u5982\u521B\u5EFA\u4E00\u4E2A\u4F9B\u524D\u7AEF\u8C03\u7528\u7684\u67E5\u8BE2\u63A5\u53E3\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> Controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../../core/baseController&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MeasureController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>\n\n\n  <span class="token comment">// \u641C\u7D22\u5217\u8868</span>\n  <span class="token keyword">async</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> current<span class="token punctuation">,</span> size<span class="token punctuation">,</span> companyName<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> endTime <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>query<span class="token punctuation">;</span>\n    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>service<span class="token punctuation">.</span>measure<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">{</span> current<span class="token punctuation">,</span> size<span class="token punctuation">,</span> companyName<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> endTime <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> MeasureController<span class="token punctuation">;</span>\n\n\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>**\u6CE8\u610F\uFF1A**Controller \u9700\u8981\u7EE7\u627F baseController \uFF08\u7EDF\u4E00\u7684 success \u65B9\u6CD5\u5C31\u6765\u81EA\u4E8EbaseController\uFF09</p><h2 id="_2-\u7F16\u5199-service" tabindex="-1"><a class="header-anchor" href="#_2-\u7F16\u5199-service" aria-hidden="true">#</a> \uFF082\uFF09\u7F16\u5199 Service</h2><p>\u5728service\u4E2D\u7F16\u5199\u63A5\u53E3\u903B\u8F91\u3002\u6309\u529F\u80FD\u6A21\u5757\u533A\u5206\u597D\u76EE\u5F55\uFF0C\u5728 app/service \u521B\u5EFA\u5BF9\u5E94\u7684 service \u6587\u4EF6</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> Service <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../core/baseService&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MeasureService</span> <span class="token keyword">extends</span> <span class="token class-name">Service</span> <span class="token punctuation">{</span>\n  <span class="token doc-comment comment">/**\n   * sequelize\u5B98\u65B9\u6587\u6863\uFF1Ahttps://sequelize.org/docs/v6/\n   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">param0</span>\n   */</span>\n  <span class="token keyword">async</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> current<span class="token punctuation">,</span> size<span class="token punctuation">,</span> companyName<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> endTime <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> where <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>companyName<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      where<span class="token punctuation">.</span>company_name <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">$like</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">%</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>companyName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>startTime <span class="token operator">&amp;&amp;</span> endTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      where<span class="token punctuation">.</span>$and <span class="token operator">=</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">{</span> <span class="token literal-property property">create_time</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">$gte</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>startTime<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 00:00:00</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token punctuation">{</span> <span class="token literal-property property">create_time</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">$lte</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>endTime<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 23:59:59</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Measure<span class="token punctuation">.</span><span class="token function">findAndCountAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      where<span class="token punctuation">,</span>\n      <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token punctuation">(</span>current <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size<span class="token punctuation">,</span>\n      <span class="token literal-property property">limit</span><span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// res\u683C\u5F0F\u4E3A { count: 0, rows: [] }</span>\n    <span class="token keyword">return</span> res<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> MeasureService<span class="token punctuation">;</span>\n\n\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>**\u6CE8\u610F\uFF1A**Service\u9700\u8981\u7EE7\u627F baseService</p><h2 id="_3-\u914D\u7F6E-router" tabindex="-1"><a class="header-anchor" href="#_3-\u914D\u7F6E-router" aria-hidden="true">#</a> \uFF083\uFF09\u914D\u7F6E router</h2><p>\u5728 app/router.js \u914D\u7F6E\u63A5\u53E3\u8BF7\u6C42\u65B9\u5F0F\uFF0C \u8BF7\u6C42\u5730\u5740\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/*\n * @file: \u8DEF\u7531\u914D\u7F6E\n */</span>\n<span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>\n\n<span class="token doc-comment comment">/**\n * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Egg<span class="token punctuation">.</span>Application<span class="token punctuation">}</span></span> <span class="token parameter">app</span> - egg application\n */</span>\nmodule<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> router<span class="token punctuation">,</span> controller <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">;</span>\n  router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/webapi/node-frame/v1/page&#39;</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>webapi<span class="token punctuation">.</span>measure<span class="token punctuation">.</span>search<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>\u82E5\u9879\u76EE\u6709\u9700\u6C42\u53EF\u4EE5\u628A\u8DEF\u7531\u62C6\u5206\u5728\u591A\u4E2A\u6587\u4EF6\u4E2D\uFF0C\u53EF\u53C2\u8003\u5B98\u65B9\u6587\u6863\u5904\u7406\u3002\uFF08eggjs\u5B98\u65B9\u5E76\u4E0D\u5EFA\u8BAE\u8FD9\u4E48\u505A\uFF09</p>', 33);
const _hoisted_114 = /* @__PURE__ */ createTextVNode("\u6587\u6863\uFF1A");
const _hoisted_115 = {
  href: "https://www.eggjs.org/zh-CN/basics/router#%E5%A4%AA%E5%A4%9A%E8%B7%AF%E7%94%B1%E6%98%A0%E5%B0%84",
  target: "_blank",
  rel: "noopener noreferrer"
};
const _hoisted_116 = /* @__PURE__ */ createBaseVNode("strong", null, "https://www.eggjs.org/zh-CN/basics/router#\u592A\u591A\u8DEF\u7531\u6620\u5C04", -1);
const _hoisted_117 = /* @__PURE__ */ createStaticVNode('<h2 id="_6\u3001\u4E8B\u52A1" tabindex="-1"><a class="header-anchor" href="#_6\u3001\u4E8B\u52A1" aria-hidden="true">#</a> 6\u3001\u4E8B\u52A1</h2><p>\u4E8B\u52A1\u662F\u4F7F\u7528 sequelizerc \u6846\u67B6\u7684<code>transaction</code>\u65B9\u6CD5\u5B9E\u73B0\u7684\uFF0C\u4E3A\u4E86\u65B9\u4FBF\u7EDF\u4E00\u5904\u7406\uFF0C\u5728baseService\u4E2D\u5C01\u88C5\u4E86 transaction() \u65B9\u6CD5\u7528\u4E8E\u4E8B\u52A1\u64CD\u4F5C\u3002</p><p>\u4F7F\u7528\u4E8B\u52A1\u8FDB\u884C\u591A\u6570\u636E\u66F4\u65B0\u64CD\u4F5C\uFF1A</p><p>Controller</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> Controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../../core/baseController&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">class</span> <span class="token class-name">MeasureController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>\n\n\n  <span class="token comment">// \u4E8B\u52A1</span>\n  <span class="token keyword">async</span> <span class="token function">transactionProcessing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>service<span class="token punctuation">.</span>measure<span class="token punctuation">.</span><span class="token function">transactionProcessing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> MeasureController<span class="token punctuation">;</span>\n\n\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>Service</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>// \u5176\u4E2Dcallback \u7684\u8FD4\u56DE\u503C\u5219\u662F this.transaction \u7684\u8FD4\u56DE\u503C.\nawait this.transaction(callback)\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> Service <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../core/baseService&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MeasureService</span> <span class="token keyword">extends</span> <span class="token class-name">Service</span> <span class="token punctuation">{</span>\n\n  <span class="token comment">// \u4E8B\u52A1</span>\n  <span class="token keyword">async</span> <span class="token function">transactionProcessing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">transaction</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n      <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Measure<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        <span class="token literal-property property">measure_id</span><span class="token operator">:</span> id<span class="token punctuation">,</span>\n        <span class="token literal-property property">measure_name</span><span class="token operator">:</span> <span class="token string">&#39;\u6D4B\u8BD5\u4E8B\u52A1&#39;</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n        transaction<span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token comment">// \u6A21\u62DF\u5931\u8D25\u7684\u60C5\u51B5</span>\n      <span class="token comment">// await this.ctx.model.Measure.create({</span>\n      <span class="token comment">//   measure_id: id,</span>\n      <span class="token comment">//   measure_name: &#39;\u6D4B\u8BD5\u4E8B\u52A1&#39;,</span>\n      <span class="token comment">// }, {</span>\n      <span class="token comment">//   transaction,</span>\n      <span class="token comment">// });</span>\n      <span class="token comment">// \u6A21\u62DF\u5931\u8D25\u7684\u60C5\u51B5</span>\n\n      <span class="token keyword">return</span> res<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> result<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> MeasureService<span class="token punctuation">;</span>\n\n\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>\u4F7F\u7528 this.transaction \u65B9\u6CD5\u521B\u5EFA\u4E00\u4E2A\u4E8B\u52A1\u3002\u9700\u8981\u628A\u56DE\u8C03\u65B9\u6CD5\u4E2D\u8FD4\u56DE\u7684\u4E8B\u52A1\u5BF9\u8C61 transaction \uFF0C\u5199\u5165\u6BCF\u4E2A\u6570\u636E\u5E93\u64CD\u4F5C\u4E2D\u3002</p><h2 id="_7\u3001\u4E0E\u65E7\u7248\u6846\u67B6\u7684\u5DEE\u5F02" tabindex="-1"><a class="header-anchor" href="#_7\u3001\u4E0E\u65E7\u7248\u6846\u67B6\u7684\u5DEE\u5F02" aria-hidden="true">#</a> 7\u3001\u4E0E\u65E7\u7248\u6846\u67B6\u7684\u5DEE\u5F02</h2><h2 id="_1-\u5FAE\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_1-\u5FAE\u670D\u52A1" aria-hidden="true">#</a> \uFF081\uFF09\u5FAE\u670D\u52A1</h2><p>\u4F7F\u7528\u4E86 <code>eggjs-nacos</code>\u63D2\u4EF6\u5B9E\u73B0\u5FAE\u670D\u52A1\u7684\u8C03\u7528\uFF0C\u82E5\u65E0\u9700\u4F7F\u7528\u5FAE\u670D\u52A1\u3002\u53EF\u53BB\u9664\u4EE5\u4E0B\u914D\u7F6E\uFF0C\u6216\u8005\u628A enable \u6539\u4E3A false</p><p>config/plugin.js</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>module.exports = {\n \n ...\n  nacos: {\n    enable: true,\n    package: &#39;eggjs-nacos&#39;,\n  },\n  ...\n}\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>config/config.local.js</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>module.exports = appInfo =&gt; {\n  config.nacos = {\n    ...\n  }\n}\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_2-\u65E5\u5FD7-1" tabindex="-1"><a class="header-anchor" href="#_2-\u65E5\u5FD7-1" aria-hidden="true">#</a> \uFF082\uFF09 \u65E5\u5FD7</h2><p>\u5728 config/config.local.js \u914D\u7F6E\u4E86\u7EDF\u4E00\u7684\u65E5\u5FD7\u683C\u5F0F\uFF0C\u8F93\u51FA\u76EE\u5F55\u7B49\u3002</p><h2 id="_3-middleware\u4E2D\u95F4\u4EF6\u7EDF\u4E00\u903B\u8F91\u4FEE\u6539" tabindex="-1"><a class="header-anchor" href="#_3-middleware\u4E2D\u95F4\u4EF6\u7EDF\u4E00\u903B\u8F91\u4FEE\u6539" aria-hidden="true">#</a> \uFF083\uFF09middleware\u4E2D\u95F4\u4EF6\u7EDF\u4E00\u903B\u8F91\u4FEE\u6539</h2><h2 id="_4-controller-\u76EE\u5F55\u5206\u5C42" tabindex="-1"><a class="header-anchor" href="#_4-controller-\u76EE\u5F55\u5206\u5C42" aria-hidden="true">#</a> \uFF084\uFF09controller \u76EE\u5F55\u5206\u5C42</h2><h2 id="_5-\u6570\u636E\u5E93\u4F7F\u7528-sequelizerc-\u8BBF\u95EE" tabindex="-1"><a class="header-anchor" href="#_5-\u6570\u636E\u5E93\u4F7F\u7528-sequelizerc-\u8BBF\u95EE" aria-hidden="true">#</a> \uFF085\uFF09\u6570\u636E\u5E93\u4F7F\u7528 sequelizerc \u8BBF\u95EE</h2><p>\u6B64\u6539\u52A8\u4E0E\u539F\u6846\u67B6\u5DEE\u522B\u8F83\u5927\uFF0C\u6846\u67B6\u8FC1\u79FB\u65F6\u9700\u8981\u6CE8\u610F\u3002\u539F\u6846\u67B6\u4F7F\u7528 <code>egg-mysql</code> \u76F4\u63A5\u8BBF\u95EE\u6570\u636E\u5E93\uFF0C\u8FC1\u79FB\u5230\u65B0\u6846\u67B6\u4E4B\u540E\u8BBF\u95EE\u6570\u636E\u5E93\u7684\u65B9\u6CD5\u9700\u8981\u5BF9\u5E94\u6539\u6210 <code>egg-sequelize</code> \u8BBF\u95EE\u6570\u636E\u5E93\u7684\u65B9\u6CD5</p><p>\u4F8B\u5982\uFF1A</p><p>egg-mysql(\u539F\u6846\u67B6) curd \u65B9\u6CD5</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u63D2\u5165</span>\n<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">&#39;posts&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;Hello World&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u5728 post \u8868\u4E2D\uFF0C\u63D2\u5165 title \u4E3A Hello World \u7684\u8BB0\u5F55</span>\n\n<span class="token comment">// \u66F4\u65B0</span>\n<span class="token keyword">const</span> row <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;fengmk2&#39;</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">otherField</span><span class="token operator">:</span> <span class="token string">&#39;other field value&#39;</span><span class="token punctuation">,</span>    <span class="token comment">// any other fields u want to update</span>\n  <span class="token literal-property property">modifiedAt</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>literals<span class="token punctuation">.</span>now<span class="token punctuation">,</span> <span class="token comment">// `now()` on db server</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">&#39;posts&#39;</span><span class="token punctuation">,</span> row<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u66F4\u65B0 posts \u8868\u4E2D\u7684\u8BB0\u5F55</span>\n\n<span class="token comment">// \u67E5\u8BE2</span>\n<span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&#39;posts&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">// \u641C\u7D22 post \u8868</span>\n  <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">&#39;draft&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">author</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;author1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;author2&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// WHERE \u6761\u4EF6</span>\n  <span class="token literal-property property">columns</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;author&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;title&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// \u8981\u67E5\u8BE2\u7684\u8868\u5B57\u6BB5</span>\n  <span class="token literal-property property">orders</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&#39;created_at&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;desc&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;desc&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// \u6392\u5E8F\u65B9\u5F0F</span>\n  <span class="token literal-property property">limit</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment">// \u8FD4\u56DE\u6570\u636E\u91CF</span>\n  <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// \u6570\u636E\u504F\u79FB\u91CF</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// \u5220\u9664</span>\n<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&#39;posts&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n  <span class="token literal-property property">author</span><span class="token operator">:</span> <span class="token string">&#39;fengmk2&#39;</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n\n\n</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>egg-sequelize\uFF08\u65B0\u6846\u67B6\uFF09\u7684curd\u53EF\u4EE5\u53C2\u8003\u6B64\u6587\u6863\u7684 3.3</p><p>\u5B98\u7F51\u6587\u6863\u5BF9\u6BD4\uFF1A</p>', 27);
const _hoisted_144 = /* @__PURE__ */ createTextVNode("egg-mysql\uFF1A ");
const _hoisted_145 = {
  href: "https://www.eggjs.org/zh-CN/tutorials/mysql#create",
  target: "_blank",
  rel: "noopener noreferrer"
};
const _hoisted_146 = /* @__PURE__ */ createBaseVNode("strong", null, "https://www.eggjs.org/zh-CN/tutorials/mysql#create", -1);
const _hoisted_147 = /* @__PURE__ */ createTextVNode("egg-sequelize\uFF1A");
const _hoisted_148 = {
  href: "https://www.eggjs.org/zh-CN/tutorials/sequelize",
  target: "_blank",
  rel: "noopener noreferrer"
};
const _hoisted_149 = /* @__PURE__ */ createBaseVNode("strong", null, "https://www.eggjs.org/zh-CN/tutorials/sequelize", -1);
const _hoisted_150 = /* @__PURE__ */ createBaseVNode("h2", {
  id: "_6-\u7F51\u5173",
  tabindex: "-1"
}, [
  /* @__PURE__ */ createBaseVNode("a", {
    class: "header-anchor",
    href: "#_6-\u7F51\u5173",
    "aria-hidden": "true"
  }, "#"),
  /* @__PURE__ */ createTextVNode(" \uFF086\uFF09\u7F51\u5173")
], -1);
const _hoisted_151 = /* @__PURE__ */ createTextVNode("\u7F51\u5173\uFF1A");
const _hoisted_152 = {
  href: "https://codeup.aliyun.com/5f009f6e6a575d7f23661045/product/backend/gateway",
  target: "_blank",
  rel: "noopener noreferrer"
};
const _hoisted_153 = /* @__PURE__ */ createBaseVNode("strong", null, "https://codeup.aliyun.com/5f009f6e6a575d7f23661045/product/backend/gateway", -1);
const _hoisted_154 = /* @__PURE__ */ createBaseVNode("p", null, "\u63A5\u53E3\u9700\u8981\u7ECF\u8FC7\u7F51\u5173\u4E4B\u540E\u518D\u5230\u670D\u52A1\u3002\u8BF7\u6C42\u8FDB\u5165\u7F51\u5173\u540E\uFF0C \u7F51\u5173\u6839\u636E\u8BF7\u6C42\u6A21\u5757\u7C7B\u578B\u8FDB\u884C\u5206\u53D1\uFF0C\u5206\u53D1\u524D\u4F1A\u628A\u5F53\u524D\u8BF7\u6C42\u7684\u7528\u6237\u4FE1\u606F\u3001\u4F01\u4E1A\u4FE1\u606F\u52A0\u5165\u8BF7\u6C42\u5934\uFF0C\u518D\u5206\u53D1\u5230\u5404\u4E2A\u670D\u52A1\u3002\u53EF\u4EE5\u5728request.header \u4E2D\u83B7\u53D6\u5230\u76F8\u5173\u4FE1\u606F\u3002", -1);
const _hoisted_155 = /* @__PURE__ */ createBaseVNode("p", null, "baseController \u548C baseService \u4E2D\u5DF2\u7ECF\u5C01\u88C5\u4E86\u76F8\u5E94\u7684\u65B9\u6CD5\u3002", -1);
const _hoisted_156 = /* @__PURE__ */ createBaseVNode("p", null, [
  /* @__PURE__ */ createBaseVNode("img", {
    src: _imports_9,
    alt: ""
  })
], -1);
const _hoisted_157 = /* @__PURE__ */ createBaseVNode("p", null, "\u7F51\u5173\u914D\u7F6E\uFF1A", -1);
const _hoisted_158 = /* @__PURE__ */ createBaseVNode("p", null, "\u5728 application-local.yml \u4E2D\u914D\u7F6E\u5BF9\u5E94\u9879\u76EE\u7684\u5FAE\u670D\u52A1\u540D\uFF0C \u8BF7\u6C42\u57DF\u540D\u3002\u8FD0\u884C\u670D\u52A1\u5373\u53EF", -1);
const _hoisted_159 = /* @__PURE__ */ createBaseVNode("p", null, [
  /* @__PURE__ */ createBaseVNode("img", {
    src: _imports_10,
    alt: ""
  })
], -1);
const _hoisted_160 = /* @__PURE__ */ createBaseVNode("h2", {
  id: "\u4F1A\u8BAE\u5F55\u5236",
  tabindex: "-1"
}, [
  /* @__PURE__ */ createBaseVNode("a", {
    class: "header-anchor",
    href: "#\u4F1A\u8BAE\u5F55\u5236",
    "aria-hidden": "true"
  }, "#"),
  /* @__PURE__ */ createTextVNode(" \u4F1A\u8BAE\u5F55\u5236")
], -1);
const _hoisted_161 = /* @__PURE__ */ createBaseVNode("p", null, "\u4E3B\u9898 :nodejs\u5FAE\u524D\u7AEF\u6846\u67B6\u4ECB\u7ECD", -1);
const _hoisted_162 = {
  href: "https://meeting.tencent.com/v2/cloud-record/share?id=304f4fde-de87-44f6-aae0-8fb1c05f2ccb&from=3",
  target: "_blank",
  rel: "noopener noreferrer"
};
const _hoisted_163 = /* @__PURE__ */ createTextVNode("\u5F55\u5236\u6587\u4EF6");
function _sfc_render(_ctx, _cache) {
  const _component_ExternalLinkIcon = resolveComponent("ExternalLinkIcon");
  return openBlock(), createElementBlock(Fragment, null, [
    _hoisted_1,
    createBaseVNode("p", null, [
      _hoisted_2,
      createBaseVNode("a", _hoisted_3, [
        _hoisted_4,
        createVNode(_component_ExternalLinkIcon)
      ])
    ]),
    createBaseVNode("p", null, [
      _hoisted_5,
      createBaseVNode("a", _hoisted_6, [
        _hoisted_7,
        createVNode(_component_ExternalLinkIcon)
      ])
    ]),
    _hoisted_8,
    createBaseVNode("p", null, [
      _hoisted_22,
      createBaseVNode("a", _hoisted_23, [
        _hoisted_24,
        createVNode(_component_ExternalLinkIcon)
      ])
    ]),
    _hoisted_25,
    createBaseVNode("p", null, [
      _hoisted_47,
      createBaseVNode("a", _hoisted_48, [
        _hoisted_49,
        createVNode(_component_ExternalLinkIcon)
      ])
    ]),
    _hoisted_50,
    createBaseVNode("p", null, [
      _hoisted_70,
      createBaseVNode("a", _hoisted_71, [
        _hoisted_72,
        createVNode(_component_ExternalLinkIcon)
      ])
    ]),
    _hoisted_73,
    createBaseVNode("p", null, [
      _hoisted_77,
      _hoisted_78,
      createBaseVNode("a", _hoisted_79, [
        _hoisted_80,
        createVNode(_component_ExternalLinkIcon)
      ])
    ]),
    _hoisted_81,
    createBaseVNode("p", null, [
      _hoisted_114,
      createBaseVNode("a", _hoisted_115, [
        _hoisted_116,
        createVNode(_component_ExternalLinkIcon)
      ])
    ]),
    _hoisted_117,
    createBaseVNode("p", null, [
      _hoisted_144,
      createBaseVNode("a", _hoisted_145, [
        _hoisted_146,
        createVNode(_component_ExternalLinkIcon)
      ])
    ]),
    createBaseVNode("p", null, [
      _hoisted_147,
      createBaseVNode("a", _hoisted_148, [
        _hoisted_149,
        createVNode(_component_ExternalLinkIcon)
      ])
    ]),
    _hoisted_150,
    createBaseVNode("p", null, [
      _hoisted_151,
      createBaseVNode("a", _hoisted_152, [
        _hoisted_153,
        createVNode(_component_ExternalLinkIcon)
      ])
    ]),
    _hoisted_154,
    _hoisted_155,
    _hoisted_156,
    _hoisted_157,
    _hoisted_158,
    _hoisted_159,
    _hoisted_160,
    _hoisted_161,
    createBaseVNode("p", null, [
      createBaseVNode("a", _hoisted_162, [
        _hoisted_163,
        createVNode(_component_ExternalLinkIcon)
      ])
    ])
  ], 64);
}
var nodejs_____html = /* @__PURE__ */ _export_sfc(_sfc_main, [["render", _sfc_render], ["__file", "nodejs\u6846\u67B6\u6587\u6863.html.vue"]]);
export { nodejs_____html as default };
