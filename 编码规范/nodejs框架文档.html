<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.43">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" type="image/png" href="/frontend-md/images/mine.png"><meta name="msapplication-TileColor" content="#3eaf7c"><meta name="theme-color" content="#3eaf7c"><title>nodejs框架文档 | 前端文档库</title><meta name="description" content="基于 VuePress 搭建的在线文档库">
    <link rel="modulepreload" href="/frontend-md/assets/app.050d295a.js"><link rel="modulepreload" href="/frontend-md/assets/nodejs框架文档.html.e1317565.js"><link rel="modulepreload" href="/frontend-md/assets/nodejs框架文档.html.8245bfc4.js"><link rel="prefetch" href="/frontend-md/assets/index.html.a72b7412.js"><link rel="prefetch" href="/frontend-md/assets/2020年总结.html.0570d4fe.js"><link rel="prefetch" href="/frontend-md/assets/2021年总结.html.db1d524f.js"><link rel="prefetch" href="/frontend-md/assets/index.html.7729389c.js"><link rel="prefetch" href="/frontend-md/assets/低代码平台.html.ceae4fec.js"><link rel="prefetch" href="/frontend-md/assets/低代码平台数据库.html.1100d4bb.js"><link rel="prefetch" href="/frontend-md/assets/前端实习招聘总结.html.2296e634.js"><link rel="prefetch" href="/frontend-md/assets/前端工作规划.html.242ad734.js"><link rel="prefetch" href="/frontend-md/assets/前端面试关注点.html.0f21a0fd.js"><link rel="prefetch" href="/frontend-md/assets/前端面试题目(答案).html.21cde878.js"><link rel="prefetch" href="/frontend-md/assets/招聘流程优化.html.45fe950b.js"><link rel="prefetch" href="/frontend-md/assets/面试题数据库设计.html.9adbca1e.js"><link rel="prefetch" href="/frontend-md/assets/index.html.b4dfea1b.js"><link rel="prefetch" href="/frontend-md/assets/生产环境发布前端页面.html.bf7ccd52.js"><link rel="prefetch" href="/frontend-md/assets/项目搭建.html.1708a044.js"><link rel="prefetch" href="/frontend-md/assets/index.html.2a2d45ef.js"><link rel="prefetch" href="/frontend-md/assets/前端技术培训说明.html.1e4f05de.js"><link rel="prefetch" href="/frontend-md/assets/技术分享介绍.html.6287a0a4.js"><link rel="prefetch" href="/frontend-md/assets/index.html.8fcc3595.js"><link rel="prefetch" href="/frontend-md/assets/公司工具介绍.html.64f550b5.js"><link rel="prefetch" href="/frontend-md/assets/前端知识体系整理.html.a034976d.js"><link rel="prefetch" href="/frontend-md/assets/周报汇报格式.html.b7b06656.js"><link rel="prefetch" href="/frontend-md/assets/学会拒绝.html.cb38b5ad.js"><link rel="prefetch" href="/frontend-md/assets/开发自查汇总.html.798da140.js"><link rel="prefetch" href="/frontend-md/assets/技术团队介绍.html.3ab6fe4b.js"><link rel="prefetch" href="/frontend-md/assets/新员工指南.html.dbaec445.js"><link rel="prefetch" href="/frontend-md/assets/新员工指南（前端实习）.html.154dc4ae.js"><link rel="prefetch" href="/frontend-md/assets/日报汇报格式.html.859fd705.js"><link rel="prefetch" href="/frontend-md/assets/验收规范.html.97044ed2.js"><link rel="prefetch" href="/frontend-md/assets/ESlint规范.html.1a2720ac.js"><link rel="prefetch" href="/frontend-md/assets/index.html.8f2f476d.js"><link rel="prefetch" href="/frontend-md/assets/前端规范文档.html.cdea389f.js"><link rel="prefetch" href="/frontend-md/assets/移动端项目结构.html.e3172b5a.js"><link rel="prefetch" href="/frontend-md/assets/HTML_CSS知识.html.770ab96f.js"><link rel="prefetch" href="/frontend-md/assets/JavaScript基础.html.821a3fc3.js"><link rel="prefetch" href="/frontend-md/assets/JavaScript进阶.html.7da36748.js"><link rel="prefetch" href="/frontend-md/assets/index.html.75c87ed0.js"><link rel="prefetch" href="/frontend-md/assets/React源码.html.61105584.js"><link rel="prefetch" href="/frontend-md/assets/Vue源码.html.8fd217fc.js"><link rel="prefetch" href="/frontend-md/assets/Webpack原理.html.98f1c032.js"><link rel="prefetch" href="/frontend-md/assets/前端性能优化.html.87b9a7c9.js"><link rel="prefetch" href="/frontend-md/assets/前端热门技术.html.b81c7176.js"><link rel="prefetch" href="/frontend-md/assets/数据结构和算法.html.67808079.js"><link rel="prefetch" href="/frontend-md/assets/简历.html.5b7cd3a4.js"><link rel="prefetch" href="/frontend-md/assets/自我介绍.html.fa1697c0.js"><link rel="prefetch" href="/frontend-md/assets/设计模式.html.93121462.js"><link rel="prefetch" href="/frontend-md/assets/软技能.html.a0ae85c2.js"><link rel="prefetch" href="/frontend-md/assets/APICloud 代码逻辑梳理.html.a6164c49.js"><link rel="prefetch" href="/frontend-md/assets/APICloud 调试简易指南.html.bc781ed2.js"><link rel="prefetch" href="/frontend-md/assets/APICloud 项目爬坑.html.919d1f46.js"><link rel="prefetch" href="/frontend-md/assets/App安卓模拟器调试.html.948bc78c.js"><link rel="prefetch" href="/frontend-md/assets/VSCode开发APICloud项目.html.37254fb9.js"><link rel="prefetch" href="/frontend-md/assets/uniapp打包.html.e24949bb.js"><link rel="prefetch" href="/frontend-md/assets/uniapp打包（安卓、IOS）及发布到蒲公英平台.html.895fdbb9.js"><link rel="prefetch" href="/frontend-md/assets/内衣云App入门.html.1e9b733c.js"><link rel="prefetch" href="/frontend-md/assets/内衣云App端开发文档补充.html.e6c7d9b5.js"><link rel="prefetch" href="/frontend-md/assets/index.html.07de31f3.js"><link rel="prefetch" href="/frontend-md/assets/linkkap-ui table组件介绍.html.daaf2ae1.js"><link rel="prefetch" href="/frontend-md/assets/前端引入iconfont阿里巴巴矢量图标库.html.5ae6c743.js"><link rel="prefetch" href="/frontend-md/assets/antv踩坑.html.cc95827b.js"><link rel="prefetch" href="/frontend-md/assets/npm发布_appworks.html.31cdfad4.js"><link rel="prefetch" href="/frontend-md/assets/qiankun微前端接入.html.5540f38b.js"><link rel="prefetch" href="/frontend-md/assets/人才价值评估系统体验账号.html.dcdad7ca.js"><link rel="prefetch" href="/frontend-md/assets/人才价值评估自动化项目.html.fd4e792b.js"><link rel="prefetch" href="/frontend-md/assets/人才评估系统重构总结.html.f4c69745.js"><link rel="prefetch" href="/frontend-md/assets/数据创建流程.html.068428ba.js"><link rel="prefetch" href="/frontend-md/assets/CRM-小优链服项目.html.3cf74840.js"><link rel="prefetch" href="/frontend-md/assets/uniapp入门指南.html.45003450.js"><link rel="prefetch" href="/frontend-md/assets/uniapp踩坑.html.2e539417.js"><link rel="prefetch" href="/frontend-md/assets/小程序和H5结合的整个开发流程.html.0f30630b.js"><link rel="prefetch" href="/frontend-md/assets/股链链小程序环境搭建.html.daca8410.js"><link rel="prefetch" href="/frontend-md/assets/CSS 布局.html.541201e5.js"><link rel="prefetch" href="/frontend-md/assets/CSS动画.html.e28c6ef1.js"><link rel="prefetch" href="/frontend-md/assets/HTML_CSS3新特性.html.7246b7fc.js"><link rel="prefetch" href="/frontend-md/assets/IOS切图与前端切图差异.html.8fdcc44f.js"><link rel="prefetch" href="/frontend-md/assets/JavaScript基础(一).html.91964ff1.js"><link rel="prefetch" href="/frontend-md/assets/JavaScript基础(三).html.a5c52cce.js"><link rel="prefetch" href="/frontend-md/assets/JavaScript基础(二).html.61110bf7.js"><link rel="prefetch" href="/frontend-md/assets/TypeScript基础.html.1aac232c.js"><link rel="prefetch" href="/frontend-md/assets/Typescript基础与进阶.html.3c77a815.js"><link rel="prefetch" href="/frontend-md/assets/Vue Router.html.f41a2083.js"><link rel="prefetch" href="/frontend-md/assets/Vue3新特性.html.8c05365a.js"><link rel="prefetch" href="/frontend-md/assets/axios源码浅读与async_await实现原理.html.6bd5b060.js"><link rel="prefetch" href="/frontend-md/assets/canvas相关技术分享.html.5a763b45.js"><link rel="prefetch" href="/frontend-md/assets/console 技巧.html.48cecbe9.js"><link rel="prefetch" href="/frontend-md/assets/eggjs.html.56e7a99e.js"><link rel="prefetch" href="/frontend-md/assets/grid 布局.html.cd0eeb09.js"><link rel="prefetch" href="/frontend-md/assets/vue响应式原理.html.6243257a.js"><link rel="prefetch" href="/frontend-md/assets/webpack_babel_eslint_sass_less.html.a0c4d220.js"><link rel="prefetch" href="/frontend-md/assets/二叉树.html.413fdbe5.js"><link rel="prefetch" href="/frontend-md/assets/代码安全_网络攻击与防御.html.48ce66de.js"><link rel="prefetch" href="/frontend-md/assets/前端工程化（一）.html.15c3de70.js"><link rel="prefetch" href="/frontend-md/assets/前端组件化.html.3dc2226d.js"><link rel="prefetch" href="/frontend-md/assets/单元测试——Jest.html.eec1bbb3.js"><link rel="prefetch" href="/frontend-md/assets/如何做SEO.html.43022d8b.js"><link rel="prefetch" href="/frontend-md/assets/数据结构和算法入门.html.c5b896ef.js"><link rel="prefetch" href="/frontend-md/assets/浏览器渲染.html.2d5e8a5e.js"><link rel="prefetch" href="/frontend-md/assets/浏览器知识（一）.html.1fd8b26c.js"><link rel="prefetch" href="/frontend-md/assets/计算机网络知识点.html.19d24d63.js"><link rel="prefetch" href="/frontend-md/assets/PC网页生成PDF方案.html.2aca805d.js"><link rel="prefetch" href="/frontend-md/assets/uni-app框架实践运用.html.30a43461.js"><link rel="prefetch" href="/frontend-md/assets/webpack实现模块化.html.ef04a558.js"><link rel="prefetch" href="/frontend-md/assets/webpack构建多页应用.html.66527858.js"><link rel="prefetch" href="/frontend-md/assets/低代码平台-可视化搭建项目.html.8832bd76.js"><link rel="prefetch" href="/frontend-md/assets/前端实习招聘总结.html.1372967a.js"><link rel="prefetch" href="/frontend-md/assets/前端性能优化.html.cf3171c6.js"><link rel="prefetch" href="/frontend-md/assets/微前端_qiankun介绍.html.93354d80.js"><link rel="prefetch" href="/frontend-md/assets/性能优化.html.685f534b.js"><link rel="prefetch" href="/frontend-md/assets/数据库原理与流.html.b2e68925.js"><link rel="prefetch" href="/frontend-md/assets/移动端 1px 问题解决方案.html.140370bd.js"><link rel="prefetch" href="/frontend-md/assets/设计store的用法.html.e33e8166.js"><link rel="prefetch" href="/frontend-md/assets/问卷系统的设计和框架.html.8adf89ef.js"><link rel="prefetch" href="/frontend-md/assets/一对一导师说明.html.3537f063.js"><link rel="prefetch" href="/frontend-md/assets/第一周的前端培训.html.03234d34.js"><link rel="prefetch" href="/frontend-md/assets/第七周的前端培训.html.d59e9a88.js"><link rel="prefetch" href="/frontend-md/assets/第三周的前端培训.html.87722d51.js"><link rel="prefetch" href="/frontend-md/assets/第九周的前端培训.html.38ee9d46.js"><link rel="prefetch" href="/frontend-md/assets/第二周的前端培训.html.e51cfbe7.js"><link rel="prefetch" href="/frontend-md/assets/第五周的前端培训.html.a12d395a.js"><link rel="prefetch" href="/frontend-md/assets/第八周的前端培训.html.a0b427b6.js"><link rel="prefetch" href="/frontend-md/assets/第六周的前端培训.html.a73c81f0.js"><link rel="prefetch" href="/frontend-md/assets/第十周的前端培训.html.f5c10229.js"><link rel="prefetch" href="/frontend-md/assets/第四周的前端培训.html.c8f4d277.js"><link rel="prefetch" href="/frontend-md/assets/梁天誉-金色摇篮项目总结.html.1f414ef3.js"><link rel="prefetch" href="/frontend-md/assets/金色摇篮项目入门文档.html.fcdf6c49.js"><link rel="prefetch" href="/frontend-md/assets/代码仓库管理.html.8050ec2d.js"><link rel="prefetch" href="/frontend-md/assets/代码分支.html.3b118447.js"><link rel="prefetch" href="/frontend-md/assets/版本规范.html.ca995c57.js"><link rel="prefetch" href="/frontend-md/assets/Git的基本使用.html.9a97d48a.js"><link rel="prefetch" href="/frontend-md/assets/babel 文档.html.1d5311c5.js"><link rel="prefetch" href="/frontend-md/assets/eslint 文档.html.a086de65.js"><link rel="prefetch" href="/frontend-md/assets/移动端布局.html.76aa3c5a.js"><link rel="prefetch" href="/frontend-md/assets/404.html.93146c89.js"><link rel="prefetch" href="/frontend-md/assets/index.html.59d30dba.js"><link rel="prefetch" href="/frontend-md/assets/2020年总结.html.0bb5bf2e.js"><link rel="prefetch" href="/frontend-md/assets/2021年总结.html.f9563943.js"><link rel="prefetch" href="/frontend-md/assets/index.html.c58e6b6b.js"><link rel="prefetch" href="/frontend-md/assets/低代码平台.html.7b5ce471.js"><link rel="prefetch" href="/frontend-md/assets/低代码平台数据库.html.88ee21bc.js"><link rel="prefetch" href="/frontend-md/assets/前端实习招聘总结.html.21f42102.js"><link rel="prefetch" href="/frontend-md/assets/前端工作规划.html.5fdd15eb.js"><link rel="prefetch" href="/frontend-md/assets/前端面试关注点.html.60dbd9e5.js"><link rel="prefetch" href="/frontend-md/assets/前端面试题目(答案).html.4e65ec9f.js"><link rel="prefetch" href="/frontend-md/assets/招聘流程优化.html.c449e133.js"><link rel="prefetch" href="/frontend-md/assets/面试题数据库设计.html.c74d77e0.js"><link rel="prefetch" href="/frontend-md/assets/index.html.b02c62b6.js"><link rel="prefetch" href="/frontend-md/assets/生产环境发布前端页面.html.3baff618.js"><link rel="prefetch" href="/frontend-md/assets/项目搭建.html.d8ca65a4.js"><link rel="prefetch" href="/frontend-md/assets/index.html.8b57a86e.js"><link rel="prefetch" href="/frontend-md/assets/前端技术培训说明.html.47c4365d.js"><link rel="prefetch" href="/frontend-md/assets/技术分享介绍.html.30883f47.js"><link rel="prefetch" href="/frontend-md/assets/index.html.fb35b746.js"><link rel="prefetch" href="/frontend-md/assets/公司工具介绍.html.9ed375b4.js"><link rel="prefetch" href="/frontend-md/assets/前端知识体系整理.html.14714035.js"><link rel="prefetch" href="/frontend-md/assets/周报汇报格式.html.4dc2881b.js"><link rel="prefetch" href="/frontend-md/assets/学会拒绝.html.8f56b0ee.js"><link rel="prefetch" href="/frontend-md/assets/开发自查汇总.html.2b84b591.js"><link rel="prefetch" href="/frontend-md/assets/技术团队介绍.html.7262fb66.js"><link rel="prefetch" href="/frontend-md/assets/新员工指南.html.b6349b29.js"><link rel="prefetch" href="/frontend-md/assets/新员工指南（前端实习）.html.d1b251a0.js"><link rel="prefetch" href="/frontend-md/assets/日报汇报格式.html.61b9a336.js"><link rel="prefetch" href="/frontend-md/assets/验收规范.html.181baf63.js"><link rel="prefetch" href="/frontend-md/assets/ESlint规范.html.345a3905.js"><link rel="prefetch" href="/frontend-md/assets/index.html.8ff9b2dd.js"><link rel="prefetch" href="/frontend-md/assets/前端规范文档.html.58781175.js"><link rel="prefetch" href="/frontend-md/assets/移动端项目结构.html.8542ceb8.js"><link rel="prefetch" href="/frontend-md/assets/HTML_CSS知识.html.2ca55f32.js"><link rel="prefetch" href="/frontend-md/assets/JavaScript基础.html.2a429697.js"><link rel="prefetch" href="/frontend-md/assets/JavaScript进阶.html.acc3f766.js"><link rel="prefetch" href="/frontend-md/assets/index.html.95fb7ce3.js"><link rel="prefetch" href="/frontend-md/assets/React源码.html.e18ace89.js"><link rel="prefetch" href="/frontend-md/assets/Vue源码.html.c826b346.js"><link rel="prefetch" href="/frontend-md/assets/Webpack原理.html.13f06d95.js"><link rel="prefetch" href="/frontend-md/assets/前端性能优化.html.ad63cfc6.js"><link rel="prefetch" href="/frontend-md/assets/前端热门技术.html.40528f33.js"><link rel="prefetch" href="/frontend-md/assets/数据结构和算法.html.be634d71.js"><link rel="prefetch" href="/frontend-md/assets/简历.html.a6af8b1b.js"><link rel="prefetch" href="/frontend-md/assets/自我介绍.html.73f80633.js"><link rel="prefetch" href="/frontend-md/assets/设计模式.html.28362897.js"><link rel="prefetch" href="/frontend-md/assets/软技能.html.32245160.js"><link rel="prefetch" href="/frontend-md/assets/APICloud 代码逻辑梳理.html.e33cdb5b.js"><link rel="prefetch" href="/frontend-md/assets/APICloud 调试简易指南.html.965c4bdb.js"><link rel="prefetch" href="/frontend-md/assets/APICloud 项目爬坑.html.5be264ee.js"><link rel="prefetch" href="/frontend-md/assets/App安卓模拟器调试.html.df8e922e.js"><link rel="prefetch" href="/frontend-md/assets/VSCode开发APICloud项目.html.5369ba4b.js"><link rel="prefetch" href="/frontend-md/assets/uniapp打包.html.47ef572c.js"><link rel="prefetch" href="/frontend-md/assets/uniapp打包（安卓、IOS）及发布到蒲公英平台.html.fcfa91e9.js"><link rel="prefetch" href="/frontend-md/assets/内衣云App入门.html.fe9a1c8d.js"><link rel="prefetch" href="/frontend-md/assets/内衣云App端开发文档补充.html.4b67c9d6.js"><link rel="prefetch" href="/frontend-md/assets/index.html.28bb931e.js"><link rel="prefetch" href="/frontend-md/assets/linkkap-ui table组件介绍.html.48c12cc2.js"><link rel="prefetch" href="/frontend-md/assets/前端引入iconfont阿里巴巴矢量图标库.html.5dbab918.js"><link rel="prefetch" href="/frontend-md/assets/antv踩坑.html.b0e79f85.js"><link rel="prefetch" href="/frontend-md/assets/npm发布_appworks.html.cd1afafb.js"><link rel="prefetch" href="/frontend-md/assets/qiankun微前端接入.html.56bbce07.js"><link rel="prefetch" href="/frontend-md/assets/人才价值评估系统体验账号.html.64e6e3e5.js"><link rel="prefetch" href="/frontend-md/assets/人才价值评估自动化项目.html.5ac5c086.js"><link rel="prefetch" href="/frontend-md/assets/人才评估系统重构总结.html.d71515f5.js"><link rel="prefetch" href="/frontend-md/assets/数据创建流程.html.1b66a84e.js"><link rel="prefetch" href="/frontend-md/assets/CRM-小优链服项目.html.6c66580a.js"><link rel="prefetch" href="/frontend-md/assets/uniapp入门指南.html.ba6bfa1c.js"><link rel="prefetch" href="/frontend-md/assets/uniapp踩坑.html.6dba6f86.js"><link rel="prefetch" href="/frontend-md/assets/小程序和H5结合的整个开发流程.html.e3e6d44a.js"><link rel="prefetch" href="/frontend-md/assets/股链链小程序环境搭建.html.4ad0102f.js"><link rel="prefetch" href="/frontend-md/assets/CSS 布局.html.f0c70342.js"><link rel="prefetch" href="/frontend-md/assets/CSS动画.html.7b1f151a.js"><link rel="prefetch" href="/frontend-md/assets/HTML_CSS3新特性.html.e49594c2.js"><link rel="prefetch" href="/frontend-md/assets/IOS切图与前端切图差异.html.0ba936ed.js"><link rel="prefetch" href="/frontend-md/assets/JavaScript基础(一).html.1c6fdb98.js"><link rel="prefetch" href="/frontend-md/assets/JavaScript基础(三).html.d47344f4.js"><link rel="prefetch" href="/frontend-md/assets/JavaScript基础(二).html.3e514623.js"><link rel="prefetch" href="/frontend-md/assets/TypeScript基础.html.12fa22ae.js"><link rel="prefetch" href="/frontend-md/assets/Typescript基础与进阶.html.b71d1a74.js"><link rel="prefetch" href="/frontend-md/assets/Vue Router.html.d50a2f39.js"><link rel="prefetch" href="/frontend-md/assets/Vue3新特性.html.145a33ee.js"><link rel="prefetch" href="/frontend-md/assets/axios源码浅读与async_await实现原理.html.6fcd4d44.js"><link rel="prefetch" href="/frontend-md/assets/canvas相关技术分享.html.3bb852d2.js"><link rel="prefetch" href="/frontend-md/assets/console 技巧.html.4cdbbc03.js"><link rel="prefetch" href="/frontend-md/assets/eggjs.html.3d936969.js"><link rel="prefetch" href="/frontend-md/assets/grid 布局.html.4f72dd23.js"><link rel="prefetch" href="/frontend-md/assets/vue响应式原理.html.102529e2.js"><link rel="prefetch" href="/frontend-md/assets/webpack_babel_eslint_sass_less.html.a8e26971.js"><link rel="prefetch" href="/frontend-md/assets/二叉树.html.7fe1b58a.js"><link rel="prefetch" href="/frontend-md/assets/代码安全_网络攻击与防御.html.1e015c82.js"><link rel="prefetch" href="/frontend-md/assets/前端工程化（一）.html.7345c3af.js"><link rel="prefetch" href="/frontend-md/assets/前端组件化.html.c6fa9a4f.js"><link rel="prefetch" href="/frontend-md/assets/单元测试——Jest.html.2351678c.js"><link rel="prefetch" href="/frontend-md/assets/如何做SEO.html.79449bb6.js"><link rel="prefetch" href="/frontend-md/assets/数据结构和算法入门.html.01bbb7d1.js"><link rel="prefetch" href="/frontend-md/assets/浏览器渲染.html.32ecaafc.js"><link rel="prefetch" href="/frontend-md/assets/浏览器知识（一）.html.1b37b683.js"><link rel="prefetch" href="/frontend-md/assets/计算机网络知识点.html.1d7802ab.js"><link rel="prefetch" href="/frontend-md/assets/PC网页生成PDF方案.html.d1392d0e.js"><link rel="prefetch" href="/frontend-md/assets/uni-app框架实践运用.html.63adbf93.js"><link rel="prefetch" href="/frontend-md/assets/webpack实现模块化.html.251ca3e0.js"><link rel="prefetch" href="/frontend-md/assets/webpack构建多页应用.html.5df0679c.js"><link rel="prefetch" href="/frontend-md/assets/低代码平台-可视化搭建项目.html.b9fec769.js"><link rel="prefetch" href="/frontend-md/assets/前端实习招聘总结.html.1670f336.js"><link rel="prefetch" href="/frontend-md/assets/前端性能优化.html.a7fa08e0.js"><link rel="prefetch" href="/frontend-md/assets/微前端_qiankun介绍.html.2e02affc.js"><link rel="prefetch" href="/frontend-md/assets/性能优化.html.7756925a.js"><link rel="prefetch" href="/frontend-md/assets/数据库原理与流.html.878c8db5.js"><link rel="prefetch" href="/frontend-md/assets/移动端 1px 问题解决方案.html.d6f5a932.js"><link rel="prefetch" href="/frontend-md/assets/设计store的用法.html.e6bdf33a.js"><link rel="prefetch" href="/frontend-md/assets/问卷系统的设计和框架.html.04a88797.js"><link rel="prefetch" href="/frontend-md/assets/一对一导师说明.html.7e6157be.js"><link rel="prefetch" href="/frontend-md/assets/第一周的前端培训.html.8b78b6f6.js"><link rel="prefetch" href="/frontend-md/assets/第七周的前端培训.html.14ca181a.js"><link rel="prefetch" href="/frontend-md/assets/第三周的前端培训.html.204ebea4.js"><link rel="prefetch" href="/frontend-md/assets/第九周的前端培训.html.19b99a42.js"><link rel="prefetch" href="/frontend-md/assets/第二周的前端培训.html.d8e708eb.js"><link rel="prefetch" href="/frontend-md/assets/第五周的前端培训.html.620a4c83.js"><link rel="prefetch" href="/frontend-md/assets/第八周的前端培训.html.e22cf539.js"><link rel="prefetch" href="/frontend-md/assets/第六周的前端培训.html.bc11d4ae.js"><link rel="prefetch" href="/frontend-md/assets/第十周的前端培训.html.40282403.js"><link rel="prefetch" href="/frontend-md/assets/第四周的前端培训.html.1e637d5c.js"><link rel="prefetch" href="/frontend-md/assets/梁天誉-金色摇篮项目总结.html.cfb2b10a.js"><link rel="prefetch" href="/frontend-md/assets/金色摇篮项目入门文档.html.32b3cc53.js"><link rel="prefetch" href="/frontend-md/assets/代码仓库管理.html.c39ee5a2.js"><link rel="prefetch" href="/frontend-md/assets/代码分支.html.15a1b6e3.js"><link rel="prefetch" href="/frontend-md/assets/版本规范.html.68ae9c1b.js"><link rel="prefetch" href="/frontend-md/assets/Git的基本使用.html.811b20c2.js"><link rel="prefetch" href="/frontend-md/assets/babel 文档.html.abcbf7d4.js"><link rel="prefetch" href="/frontend-md/assets/eslint 文档.html.31915bd1.js"><link rel="prefetch" href="/frontend-md/assets/移动端布局.html.f422ac48.js"><link rel="prefetch" href="/frontend-md/assets/404.html.7b5c7ab7.js"><link rel="prefetch" href="/frontend-md/assets/404.b3ed83f0.js"><link rel="prefetch" href="/frontend-md/assets/Layout.792d1930.js">
    <link rel="stylesheet" href="/frontend-md/assets/style.2825d095.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="切换侧边栏" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/frontend-md/" class=""><img class="logo" src="/frontend-md/images/mine.png" alt="前端文档库"><span class="site-name can-hide">前端文档库</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/frontend-md/新人入门/" class="" aria-label="新人入门"><!--[--><!--]--> 新人入门 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/frontend-md/前端规划/" class="" aria-label="前端规划"><!--[--><!--]--> 前端规划 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/frontend-md/技术分享/" class="" aria-label="技术分享"><!--[--><!--]--> 技术分享 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/frontend-md/编码规范/" class="router-link-active" aria-label="编码规范"><!--[--><!--]--> 编码规范 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/frontend-md/前端项目/" class="" aria-label="前端项目"><!--[--><!--]--> 前端项目 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/frontend-md/高级面试/" class="" aria-label="高级面试"><!--[--><!--]--> 高级面试 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/iamouyangdan/frontend-md" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="切换夜间模式"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/frontend-md/新人入门/" class="" aria-label="新人入门"><!--[--><!--]--> 新人入门 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/frontend-md/前端规划/" class="" aria-label="前端规划"><!--[--><!--]--> 前端规划 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/frontend-md/技术分享/" class="" aria-label="技术分享"><!--[--><!--]--> 技术分享 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/frontend-md/编码规范/" class="router-link-active" aria-label="编码规范"><!--[--><!--]--> 编码规范 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/frontend-md/前端项目/" class="" aria-label="前端项目"><!--[--><!--]--> 前端项目 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/frontend-md/高级面试/" class="" aria-label="高级面试"><!--[--><!--]--> 高级面试 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/iamouyangdan/frontend-md" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">编码规范 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/" class="router-link-active sidebar-item" aria-label="编码规范"><!--[--><!--]--> 编码规范 <!--[--><!--]--></a><!----></li><li><a href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/%E5%89%8D%E7%AB%AF%E8%A7%84%E8%8C%83%E6%96%87%E6%A1%A3.html" class="sidebar-item" aria-label="前端规范文档"><!--[--><!--]--> 前端规范文档 <!--[--><!--]--></a><!----></li><li><a href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/ESlint%E8%A7%84%E8%8C%83.html" class="sidebar-item" aria-label="ESlint规范"><!--[--><!--]--> ESlint规范 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="nodejs框架文档"><!--[--><!--]--> nodejs框架文档 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_1、代码结构" class="router-link-active router-link-exact-active sidebar-item" aria-label="1、代码结构"><!--[--><!--]--> 1、代码结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_2、配置信息" class="router-link-active router-link-exact-active sidebar-item" aria-label="2、配置信息"><!--[--><!--]--> 2、配置信息 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_1-mysql-和-redis-配置" class="router-link-active router-link-exact-active sidebar-item" aria-label="（1）mysql 和 redis 配置"><!--[--><!--]--> （1）mysql 和 redis 配置 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#mysql" class="router-link-active router-link-exact-active sidebar-item" aria-label="MySQL"><!--[--><!--]--> MySQL <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#redis" class="router-link-active router-link-exact-active sidebar-item" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_2-日志" class="router-link-active router-link-exact-active sidebar-item" aria-label="（2）日志"><!--[--><!--]--> （2）日志 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_3-微服务" class="router-link-active router-link-exact-active sidebar-item" aria-label="（3）微服务"><!--[--><!--]--> （3）微服务 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_3、数据库" class="router-link-active router-link-exact-active sidebar-item" aria-label="3、数据库"><!--[--><!--]--> 3、数据库 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_1-初始化配置" class="router-link-active router-link-exact-active sidebar-item" aria-label="（1）初始化配置"><!--[--><!--]--> （1）初始化配置 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_2-初始model" class="router-link-active router-link-exact-active sidebar-item" aria-label="（2）初始model"><!--[--><!--]--> （2）初始model <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_3-使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="（3）使用"><!--[--><!--]--> （3）使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_4-多表查询" class="router-link-active router-link-exact-active sidebar-item" aria-label="（4）多表查询"><!--[--><!--]--> （4）多表查询 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_1-关联-a-和-b-两个model" class="router-link-active router-link-exact-active sidebar-item" aria-label="（1）关联 A 和 B 两个model"><!--[--><!--]--> （1）关联 A 和 B 两个model <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_2-使用-include-参数查询" class="router-link-active router-link-exact-active sidebar-item" aria-label="（2）使用 include 参数查询"><!--[--><!--]--> （2）使用 include 参数查询 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_4、微服务" class="router-link-active router-link-exact-active sidebar-item" aria-label="4、微服务"><!--[--><!--]--> 4、微服务 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_1-配置注册微服务" class="router-link-active router-link-exact-active sidebar-item" aria-label="（1）配置注册微服务"><!--[--><!--]--> （1）配置注册微服务 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_2-调用微服务" class="router-link-active router-link-exact-active sidebar-item" aria-label="（2）调用微服务"><!--[--><!--]--> （2）调用微服务 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_5、如何编写一个接口" class="router-link-active router-link-exact-active sidebar-item" aria-label="5、如何编写一个接口"><!--[--><!--]--> 5、如何编写一个接口 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_1-编写-controller" class="router-link-active router-link-exact-active sidebar-item" aria-label="（1）编写 Controller"><!--[--><!--]--> （1）编写 Controller <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_2-编写-service" class="router-link-active router-link-exact-active sidebar-item" aria-label="（2）编写 Service"><!--[--><!--]--> （2）编写 Service <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_3-配置-router" class="router-link-active router-link-exact-active sidebar-item" aria-label="（3）配置 router"><!--[--><!--]--> （3）配置 router <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_6、事务" class="router-link-active router-link-exact-active sidebar-item" aria-label="6、事务"><!--[--><!--]--> 6、事务 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_7、与旧版框架的差异" class="router-link-active router-link-exact-active sidebar-item" aria-label="7、与旧版框架的差异"><!--[--><!--]--> 7、与旧版框架的差异 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_1-微服务" class="router-link-active router-link-exact-active sidebar-item" aria-label="（1）微服务"><!--[--><!--]--> （1）微服务 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_2-日志-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="（2） 日志"><!--[--><!--]--> （2） 日志 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_3-middleware中间件统一逻辑修改" class="router-link-active router-link-exact-active sidebar-item" aria-label="（3）middleware中间件统一逻辑修改"><!--[--><!--]--> （3）middleware中间件统一逻辑修改 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_4-controller-目录分层" class="router-link-active router-link-exact-active sidebar-item" aria-label="（4）controller 目录分层"><!--[--><!--]--> （4）controller 目录分层 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_5-数据库使用-sequelizerc-访问" class="router-link-active router-link-exact-active sidebar-item" aria-label="（5）数据库使用 sequelizerc 访问"><!--[--><!--]--> （5）数据库使用 sequelizerc 访问 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#_6-网关" class="router-link-active router-link-exact-active sidebar-item" aria-label="（6）网关"><!--[--><!--]--> （6）网关 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/nodejs%E6%A1%86%E6%9E%B6%E6%96%87%E6%A1%A3.html#会议录制" class="router-link-active router-link-exact-active sidebar-item" aria-label="会议录制"><!--[--><!--]--> 会议录制 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.html" class="sidebar-item" aria-label="移动端项目结构"><!--[--><!--]--> 移动端项目结构 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading">代码管理 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86/%E4%BB%A3%E7%A0%81%E5%88%86%E6%94%AF.html" class="sidebar-item" aria-label="代码分支"><!--[--><!--]--> 代码分支 <!--[--><!--]--></a><!----></li><li><a href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86/%E4%BB%A3%E7%A0%81%E4%BB%93%E5%BA%93%E7%AE%A1%E7%90%86.html" class="sidebar-item" aria-label="代码仓库管理"><!--[--><!--]--> 代码仓库管理 <!--[--><!--]--></a><!----></li><li><a href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86/%E7%89%88%E6%9C%AC%E8%A7%84%E8%8C%83.html" class="sidebar-item" aria-label="版本规范"><!--[--><!--]--> 版本规范 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="nodejs框架文档" tabindex="-1"><a class="header-anchor" href="#nodejs框架文档" aria-hidden="true">#</a> nodejs框架文档</h1><p>eggjs文档：<a href="https://www.eggjs.org/zh-CN" target="_blank" rel="noopener noreferrer"><strong>https://www.eggjs.org/zh-CN</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>框架代码地址：<a href="https://codeup.aliyun.com/5f009f6e6a575d7f23661045/frontend/nodejs-frame" target="_blank" rel="noopener noreferrer"><strong>https://codeup.aliyun.com/5f009f6e6a575d7f23661045/frontend/nodejs-frame</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="_1、代码结构" tabindex="-1"><a class="header-anchor" href="#_1、代码结构" aria-hidden="true">#</a> 1、代码结构</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>
├── app
│   ├── router.js  路由入口, 配置接口地址请求的地址,请求方式,对应的controller
│   ├── controller  控制器
│   │   ├── ms  给其他微服务调用的接口, 只提供给内部调用
│   │   ├── webapi  给前端调用的业务接口
│   │   └── callbackController.js  监听服务回调
│   ├── core  核心方法
│   │   │── baseController  基础controller
│   │   │── baseService  基础service
│   │   └── callbackHandler  监听以及发送通知的方法
│   ├── service  服务
│   │   └── xxx.js
│   ├── middleware  中间件
│   │   └── commonHandler.js  统一全局中间件
│   ├── utils
│   │   ├── common.js  公用方法
│   │   ├── pinyin.js  中文转拼音方法
│   │   └── snowflakeId.js  雪花id生成器
│   └── extend
│       └── helper.js  公用方法
├── config  插件配置以及各个环境的参数配置
│   ├── plugin.js  插件配置
│   ├── config.default.js
│   ├── config.prod.js  生产环境配置(包括mysql、orm框架egg─sequelize配置、redis配置、微服务nacos配置、日志打印配置等)
│   ├── config.dev.js  测试环境配置
│   └── config.local.js  本地开发环境配置
├── database
├── logs
├── scripts
├── shell  发布脚本
├── test  单元测试, 文档: https://www.eggjs.org/zh─CN/core/development#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95
├── .eslintignore  eslint忽略文件
├── .eslintrc  eslint配置文件
├── .sequelizerc  sequelizerc的配置文件
├── app.js  用于自定义启动时的初始化工作
└── package.json  项目依赖,启动脚本配置

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p><img src="/frontend-md/images/编码规范/image1.png" alt=""></p><h2 id="_2、配置信息" tabindex="-1"><a class="header-anchor" href="#_2、配置信息" aria-hidden="true">#</a> 2、配置信息</h2><p>以 config/config.local.js 为例</p><h2 id="_1-mysql-和-redis-配置" tabindex="-1"><a class="header-anchor" href="#_1-mysql-和-redis-配置" aria-hidden="true">#</a> （1）mysql 和 redis 配置</h2><p><img src="/frontend-md/images/编码规范/image2.png" alt=""></p><h3 id="mysql" tabindex="-1"><a class="header-anchor" href="#mysql" aria-hidden="true">#</a> MySQL</h3><p>数据库使用的是MySQL，这里不直接连接数据库，而是通过orm框架 egg-sequelize 来连接数据库。 使用该框架可以使数据库操作更简单。各项配置信息如下：</p><p>①需要在 config/plugin.js 中配置插件信息</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>
module.exports = {

  ...
  sequelize: {
    enable: true,
    package: &#39;egg-sequelize&#39;,
  }
  ...
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><img src="/frontend-md/images/编码规范/image3.png" alt=""></p><p>②在 config/config.local.js 中配置如下:</p><p><img src="/frontend-md/images/编码规范/image4.png" alt=""></p><p>文档：<a href="https://www.eggjs.org/zh-CN/tutorials/sequelize" target="_blank" rel="noopener noreferrer"><strong>https://www.eggjs.org/zh-CN/tutorials/sequelize</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="redis" tabindex="-1"><a class="header-anchor" href="#redis" aria-hidden="true">#</a> Redis</h3><p>①需要在 config/plugin.js 中配置插件信息</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>
module.exports = {

  ...
  redis: {
    enable: true,
    package: &#39;egg-redis&#39;,
  }
  ...
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>②在 config/config.local.js 中配置如下:</p><p><img src="/frontend-md/images/编码规范/image5.png" alt=""></p><h2 id="_2-日志" tabindex="-1"><a class="header-anchor" href="#_2-日志" aria-hidden="true">#</a> （2）日志</h2><p>日志配置如下，其中 logPath 为日志的存放路径。目前生产环境设置为 <code>/data/logs/nodejs</code> 。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>

  config<span class="token punctuation">.</span>logger <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">dir</span><span class="token operator">:</span> logPath<span class="token punctuation">,</span>
    <span class="token function">formatter</span><span class="token punctuation">(</span><span class="token parameter">meta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>meta<span class="token punctuation">.</span>message<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        meta<span class="token punctuation">.</span>message <span class="token operator">=</span> meta<span class="token punctuation">.</span>message<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;...&#39;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>meta<span class="token punctuation">.</span>date<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">  </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>meta<span class="token punctuation">.</span>level<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>meta<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// ctx logger</span>
    <span class="token function">contextFormatter</span><span class="token punctuation">(</span><span class="token parameter">meta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>meta<span class="token punctuation">.</span>message<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        meta<span class="token punctuation">.</span>message <span class="token operator">=</span> meta<span class="token punctuation">.</span>message<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;...&#39;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>meta<span class="token punctuation">.</span>date<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">  </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>meta<span class="token punctuation">.</span>level<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> - [</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>meta<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>header<span class="token punctuation">[</span><span class="token string">&#39;x-request-id&#39;</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">&#39;-&#39;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">] : </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>meta<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><code>formatter</code>与 <code>contextFormatter</code> 方法配置日志格式化，一般情况下无需更改。默认日志格式为：</p><blockquote><p>日期 日志等级 - [请求id] [文件名] 日志内容</p></blockquote><blockquote><p>日期 日志等级 - [请求id] [文件名] 接口地址 接口请求参数</p></blockquote><p><strong>部分日志内容:</strong></p><p><img src="/frontend-md/images/编码规范/image6.png" alt=""></p><p><strong>日志打印：</strong></p><p>配置好之后可以在 Controller 和 Service 里面使用 <code>logger</code>、<code>app.logger</code>、<code>ctx.logger</code>打印日志</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>ctx<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&#39;debug info&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;some request data: %j&#39;</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&#39;WARNNING!!!!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 错误日志记录，直接会将错误日志完整堆栈信息记录下来，并且输出到 errorLog 中</span>
<span class="token comment">// 为了保证异常可追踪，必须保证所有抛出的异常都是 Error 类型，因为只有 Error 类型才会带上堆栈信息，定位到问题。</span>
ctx<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;whoops&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_3-微服务" tabindex="-1"><a class="header-anchor" href="#_3-微服务" aria-hidden="true">#</a> （3）微服务</h2><p>使用 <code>eggjs-nacos</code> 插件</p><p>①需要在 config/plugin.js 中配置插件信息</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>module.exports = {

  ...
  nacos: {
    enable: true,
    env: [ &#39;dev&#39;, &#39;prod&#39; ],
    package: &#39;eggjs-nacos&#39;,
  }
  ...
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>②在 config/config.local.js 中配置如下:</p><p><img src="/frontend-md/images/编码规范/image7.png" alt=""></p><p>文档地址：<a href="https://github.com/1981430140/eggjs-nacos" target="_blank" rel="noopener noreferrer"><strong>https://github.com/1981430140/eggjs-nacos</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>无需使用微服务则无需添加此配置。</p><h2 id="_3、数据库" tabindex="-1"><a class="header-anchor" href="#_3、数据库" aria-hidden="true">#</a> 3、数据库</h2><p><strong>示例数据库文件在 sql 目录中，可以导入到本地数据库使用。</strong></p><p>使用 sequelize 来访问数据库。</p><h2 id="_1-初始化配置" tabindex="-1"><a class="header-anchor" href="#_1-初始化配置" aria-hidden="true">#</a> （1）初始化配置</h2><p>① 在项目根目录创建一个 .sequelizerc 文件，指定各项配置读取路径</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">config</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;database/config.json&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token string-property property">&#39;migrations-path&#39;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;database/migrations&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token string-property property">&#39;seeders-path&#39;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;database/seeders&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token string-property property">&#39;models-path&#39;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;app/model&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>② 配置 config/plugin.js 以及 config/config.local.js</p><p>以上第二点已经提及，不再赘述。</p><p>③ 配置 数据库model相关内容</p><p>此项目使用 <code>sequelize-auto</code>插件根据连接的数据库自动生成model。自动生成的脚本是根目录下的<code>script/autoModels.js</code>此脚本在 package.json 中配置了前端安装依赖后会自动触发此脚本</p><p><strong>autoModels.js</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&#39;use strict&#39;;

const SequelizeAuto = require(&#39;sequelize-auto&#39;);
const config = require(&#39;../config/config.local.js&#39;)({ name: &#39;&#39; });

const db = {
  database: config.sequelize.database,
  host: config.sequelize.host,
  port: config.sequelize.port,
  username: config.sequelize.username,
  password: config.sequelize.password,
  dialect: config.sequelize.dialect,
};
const auto = new SequelizeAuto(db.database, db.username, db.password, {
  host: db.host,
  dialect: db.dialect,
  directory: &#39;./database/model/&#39;, // prevents the program from writing to disk
  port: db.port,
  additional: {
    timestamps: false,
  },
  // tables: []  // 指定表格
  // ...
});

auto.run(function(err) {
  if (err) throw err;
});
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h2 id="_2-初始model" tabindex="-1"><a class="header-anchor" href="#_2-初始model" aria-hidden="true">#</a> （2）初始model</h2><p>sequelize 是通过一个一个与数据库对应的model，来访问数据库的。我们需要先编写 model 才能通过 model 访问数据库。</p><p>我们可以通过 nodejs 的 fs 模块读取 database/model 来自动生成 model 文件。具体代码在 <code>script/init.js</code></p><h2 id="_3-使用" tabindex="-1"><a class="header-anchor" href="#_3-使用" aria-hidden="true">#</a> （3）使用</h2><p>配置好 Model 后就可以在Controller 和 Service 中通过 <code>app.model.Model名</code> 或者 <code>ctx.model.Model名</code> 访问到了。可以通过这个model 进行数据库操作。</p><p>官网例子：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> Controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;egg&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controller<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">toInt</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> str <span class="token operator">===</span> <span class="token string">&#39;number&#39;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> str<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>str<span class="token punctuation">)</span> <span class="token keyword">return</span> str<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">;</span>
    <span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">limit</span><span class="token operator">:</span> <span class="token function">toInt</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>query<span class="token punctuation">.</span>limit<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token function">toInt</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>query<span class="token punctuation">.</span>offset<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span>User<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span>User<span class="token punctuation">.</span><span class="token function">findByPk</span><span class="token punctuation">(</span><span class="token function">toInt</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span>User<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">201</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> user<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">;</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">toInt</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span>User<span class="token punctuation">.</span><span class="token function">findByPk</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">404</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
    <span class="token keyword">await</span> user<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> user<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">;</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">toInt</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span>User<span class="token punctuation">.</span><span class="token function">findByPk</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">404</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">await</span> user<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> UserController<span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br></div></div><p>文档：<a href="https://www.eggjs.org/zh-CN/tutorials/sequelize" target="_blank" rel="noopener noreferrer"><strong>https://www.eggjs.org/zh-CN/tutorials/sequelize</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="_4-多表查询" tabindex="-1"><a class="header-anchor" href="#_4-多表查询" aria-hidden="true">#</a> （4）多表查询</h2><p>在我们实际使用中，数据可能存在多个表中，这时我们查询数据时需要关联多个表。例如：有<code>A</code>和<code>B</code>两个模型，且A 对 B是一对多的关系。需求是：查询出A并且列出与A相关的所有B</p><h3 id="_1-关联-a-和-b-两个model" tabindex="-1"><a class="header-anchor" href="#_1-关联-a-和-b-两个model" aria-hidden="true">#</a> （1）关联 A 和 B 两个model</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 假设 B 表中, a_id字段与 A表的id 字段关联</span>
<span class="token keyword">const</span> AModel <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> BModel <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token constant">B</span><span class="token punctuation">;</span>
AModel<span class="token punctuation">.</span><span class="token function">hasMany</span><span class="token punctuation">(</span>BModel<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">sourceKey</span><span class="token operator">:</span> <span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">foreignKey</span><span class="token operator">:</span> <span class="token string">&#39;a_id&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>sequelize关联</strong>：<a href="https://www.sequelize.com.cn/core-concepts/assocs" target="_blank" rel="noopener noreferrer"><strong>https://www.sequelize.com.cn/core-concepts/assocs</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>model 的关联只需要关联一次， 无需每次查询都进行关联， 所以把关联统一在 app/core/associateModel.js 中写关联的处理逻辑。并在 app.js 中进行初始化。</p><p><img src="/frontend-md/images/编码规范/image8.png" alt=""></p><p><img src="/frontend-md/images/编码规范/image9.png" alt=""></p><h3 id="_2-使用-include-参数查询" tabindex="-1"><a class="header-anchor" href="#_2-使用-include-参数查询" aria-hidden="true">#</a> （2）使用 include 参数查询</h3><p>查询时，对A进行查询， 然后include参数包含 B模型</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">.</span><span class="token function">findAndCountAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">del_flag</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 查询考核计划</span>
  <span class="token literal-property property">include</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token constant">B</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">limit</span><span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_4、微服务" tabindex="-1"><a class="header-anchor" href="#_4、微服务" aria-hidden="true">#</a> 4、微服务</h2><h2 id="_1-配置注册微服务" tabindex="-1"><a class="header-anchor" href="#_1-配置注册微服务" aria-hidden="true">#</a> （1）配置注册微服务</h2><p>以上第二点中有描述微服务的配置</p><p>**说明：**本地服务通过 nacos 注册微服务后, 可能会导致线上服务调用到本地正在开发中的服务。 所以本地环境不注册微服务，直接通过curl调用其他第三方服务，可以配置直接调用某个域名</p><p>本地环境配置：</p><p>config.local.js</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">appInfo</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  config<span class="token punctuation">.</span>nacos <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 微服务名: 域名, </span>
    <span class="token string-property property">&#39;platform-user-center-ms&#39;</span><span class="token operator">:</span> <span class="token string">&#39;http://50100.ms.product.kapboo.com:8888&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>plugin.js</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&#39;use strict&#39;;

module.exports = {
  ...
  nacos: {
    enable: true,
    env: [ &#39;dev&#39;, &#39;prod&#39; ],
    package: &#39;eggjs-nacos&#39;,
  },
  ...
};

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_2-调用微服务" tabindex="-1"><a class="header-anchor" href="#_2-调用微服务" aria-hidden="true">#</a> （2）调用微服务</h2><p>我们已经在 config.nacos 中的 subscribers 配置声明了我们需要调用的其他微服务。我们可以在Controller 和 Service 中使用 <code>ctx.nacos[&#39;微服务别名&#39;].request(url)</code> 调用该微服务，此方法已经封装在 baseService 里面可以这样调用<code>nacos(&#39;微服务名&#39;, url, options)</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">appInfo</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  config<span class="token punctuation">.</span>nacos <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">subscribers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&#39;platform-user-center-ms&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">serviceName</span><span class="token operator">:</span> <span class="token string">&#39;platform-user-center-ms&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 服务名称</span>
        <span class="token literal-property property">groupName</span><span class="token operator">:</span> <span class="token string">&#39;DEFAULT_GROUP&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 默认 DEFAULT_GROUP</span>
        <span class="token literal-property property">clusters</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 默认 DEFAULT</span>
        <span class="token literal-property property">subscribe</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否订阅服务  默认 true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>例如以上我们配置订阅了微服务 platform-user-center-ms，调用微服务提供的“用户登录日志”接口：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Service <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../core/baseService&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MeasureService</span> <span class="token keyword">extends</span> <span class="token class-name">Service</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">fetchOtherService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">nacos</span><span class="token punctuation">(</span><span class="token string">&#39;platform-user-center-ms&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;/api/platform-user-center/platform/v1/user/login-log/list&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">dataType</span><span class="token operator">:</span> <span class="token string">&#39;json&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&#39;Content-Type&#39;</span><span class="token operator">:</span> <span class="token string">&#39;application/json&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> data <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;第三方服务返回的数据&#39;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>code <span class="token operator">!==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> data<span class="token punctuation">.</span>object<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MeasureService<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="_5、如何编写一个接口" tabindex="-1"><a class="header-anchor" href="#_5、如何编写一个接口" aria-hidden="true">#</a> 5、如何编写一个接口</h2><h2 id="_1-编写-controller" tabindex="-1"><a class="header-anchor" href="#_1-编写-controller" aria-hidden="true">#</a> （1）编写 Controller</h2><p>根据接口的功能、模块新建Controller，（接口提供给微服务内部调用则放在 app/controller/ms，提供给前端调用的接口放在 app/controller/weiapi），例如创建一个供前端调用的查询接口：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../../core/baseController&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MeasureController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>


  <span class="token comment">// 搜索列表</span>
  <span class="token keyword">async</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> current<span class="token punctuation">,</span> size<span class="token punctuation">,</span> companyName<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> endTime <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>service<span class="token punctuation">.</span>measure<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">{</span> current<span class="token punctuation">,</span> size<span class="token punctuation">,</span> companyName<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> endTime <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MeasureController<span class="token punctuation">;</span>


</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>**注意：**Controller 需要继承 baseController （统一的 success 方法就来自于baseController）</p><h2 id="_2-编写-service" tabindex="-1"><a class="header-anchor" href="#_2-编写-service" aria-hidden="true">#</a> （2）编写 Service</h2><p>在service中编写接口逻辑。按功能模块区分好目录，在 app/service 创建对应的 service 文件</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Service <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../core/baseService&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MeasureService</span> <span class="token keyword">extends</span> <span class="token class-name">Service</span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/**
   * sequelize官方文档：https://sequelize.org/docs/v6/
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">param0</span>
   */</span>
  <span class="token keyword">async</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> current<span class="token punctuation">,</span> size<span class="token punctuation">,</span> companyName<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> endTime <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> where <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>companyName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      where<span class="token punctuation">.</span>company_name <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">$like</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">%</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>companyName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>startTime <span class="token operator">&amp;&amp;</span> endTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      where<span class="token punctuation">.</span>$and <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">create_time</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">$gte</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>startTime<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 00:00:00</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">create_time</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">$lte</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>endTime<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 23:59:59</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Measure<span class="token punctuation">.</span><span class="token function">findAndCountAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      where<span class="token punctuation">,</span>
      <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token punctuation">(</span>current <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size<span class="token punctuation">,</span>
      <span class="token literal-property property">limit</span><span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// res格式为 { count: 0, rows: [] }</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MeasureService<span class="token punctuation">;</span>


</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>**注意：**Service需要继承 baseService</p><h2 id="_3-配置-router" tabindex="-1"><a class="header-anchor" href="#_3-配置-router" aria-hidden="true">#</a> （3）配置 router</h2><p>在 app/router.js 配置接口请求方式， 请求地址。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/*
 * @file: 路由配置
 */</span>
<span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Egg<span class="token punctuation">.</span>Application<span class="token punctuation">}</span></span> <span class="token parameter">app</span> - egg application
 */</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> router<span class="token punctuation">,</span> controller <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">;</span>
  router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/webapi/node-frame/v1/page&#39;</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>webapi<span class="token punctuation">.</span>measure<span class="token punctuation">.</span>search<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>若项目有需求可以把路由拆分在多个文件中，可参考官方文档处理。（eggjs官方并不建议这么做）</p><p>文档：<a href="https://www.eggjs.org/zh-CN/basics/router#%E5%A4%AA%E5%A4%9A%E8%B7%AF%E7%94%B1%E6%98%A0%E5%B0%84" target="_blank" rel="noopener noreferrer"><strong>https://www.eggjs.org/zh-CN/basics/router#太多路由映射</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="_6、事务" tabindex="-1"><a class="header-anchor" href="#_6、事务" aria-hidden="true">#</a> 6、事务</h2><p>事务是使用 sequelizerc 框架的<code>transaction</code>方法实现的，为了方便统一处理，在baseService中封装了 transaction() 方法用于事务操作。</p><p>使用事务进行多数据更新操作：</p><p>Controller</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../../core/baseController&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">MeasureController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>


  <span class="token comment">// 事务</span>
  <span class="token keyword">async</span> <span class="token function">transactionProcessing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>service<span class="token punctuation">.</span>measure<span class="token punctuation">.</span><span class="token function">transactionProcessing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MeasureController<span class="token punctuation">;</span>


</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>Service</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>// 其中callback 的返回值则是 this.transaction 的返回值.
await this.transaction(callback)
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&#39;use strict&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Service <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../core/baseService&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MeasureService</span> <span class="token keyword">extends</span> <span class="token class-name">Service</span> <span class="token punctuation">{</span>

  <span class="token comment">// 事务</span>
  <span class="token keyword">async</span> <span class="token function">transactionProcessing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">transaction</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Measure<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">measure_id</span><span class="token operator">:</span> id<span class="token punctuation">,</span>
        <span class="token literal-property property">measure_name</span><span class="token operator">:</span> <span class="token string">&#39;测试事务&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        transaction<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 模拟失败的情况</span>
      <span class="token comment">// await this.ctx.model.Measure.create({</span>
      <span class="token comment">//   measure_id: id,</span>
      <span class="token comment">//   measure_name: &#39;测试事务&#39;,</span>
      <span class="token comment">// }, {</span>
      <span class="token comment">//   transaction,</span>
      <span class="token comment">// });</span>
      <span class="token comment">// 模拟失败的情况</span>

      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MeasureService<span class="token punctuation">;</span>


</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>使用 this.transaction 方法创建一个事务。需要把回调方法中返回的事务对象 transaction ，写入每个数据库操作中。</p><h2 id="_7、与旧版框架的差异" tabindex="-1"><a class="header-anchor" href="#_7、与旧版框架的差异" aria-hidden="true">#</a> 7、与旧版框架的差异</h2><h2 id="_1-微服务" tabindex="-1"><a class="header-anchor" href="#_1-微服务" aria-hidden="true">#</a> （1）微服务</h2><p>使用了 <code>eggjs-nacos</code>插件实现微服务的调用，若无需使用微服务。可去除以下配置，或者把 enable 改为 false</p><p>config/plugin.js</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>module.exports = {
 
 ...
  nacos: {
    enable: true,
    package: &#39;eggjs-nacos&#39;,
  },
  ...
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>config/config.local.js</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>module.exports = appInfo =&gt; {
  config.nacos = {
    ...
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_2-日志-1" tabindex="-1"><a class="header-anchor" href="#_2-日志-1" aria-hidden="true">#</a> （2） 日志</h2><p>在 config/config.local.js 配置了统一的日志格式，输出目录等。</p><h2 id="_3-middleware中间件统一逻辑修改" tabindex="-1"><a class="header-anchor" href="#_3-middleware中间件统一逻辑修改" aria-hidden="true">#</a> （3）middleware中间件统一逻辑修改</h2><h2 id="_4-controller-目录分层" tabindex="-1"><a class="header-anchor" href="#_4-controller-目录分层" aria-hidden="true">#</a> （4）controller 目录分层</h2><h2 id="_5-数据库使用-sequelizerc-访问" tabindex="-1"><a class="header-anchor" href="#_5-数据库使用-sequelizerc-访问" aria-hidden="true">#</a> （5）数据库使用 sequelizerc 访问</h2><p>此改动与原框架差别较大，框架迁移时需要注意。原框架使用 <code>egg-mysql</code> 直接访问数据库，迁移到新框架之后访问数据库的方法需要对应改成 <code>egg-sequelize</code> 访问数据库的方法</p><p>例如：</p><p>egg-mysql(原框架) curd 方法</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 插入</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">&#39;posts&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;Hello World&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在 post 表中，插入 title 为 Hello World 的记录</span>

<span class="token comment">// 更新</span>
<span class="token keyword">const</span> row <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;fengmk2&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">otherField</span><span class="token operator">:</span> <span class="token string">&#39;other field value&#39;</span><span class="token punctuation">,</span>    <span class="token comment">// any other fields u want to update</span>
  <span class="token literal-property property">modifiedAt</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>literals<span class="token punctuation">.</span>now<span class="token punctuation">,</span> <span class="token comment">// `now()` on db server</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">&#39;posts&#39;</span><span class="token punctuation">,</span> row<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 更新 posts 表中的记录</span>

<span class="token comment">// 查询</span>
<span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&#39;posts&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">// 搜索 post 表</span>
  <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">&#39;draft&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">author</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;author1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;author2&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// WHERE 条件</span>
  <span class="token literal-property property">columns</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;author&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;title&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 要查询的表字段</span>
  <span class="token literal-property property">orders</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&#39;created_at&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;desc&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;desc&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 排序方式</span>
  <span class="token literal-property property">limit</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment">// 返回数据量</span>
  <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 数据偏移量</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 删除</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&#39;posts&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">author</span><span class="token operator">:</span> <span class="token string">&#39;fengmk2&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>egg-sequelize（新框架）的curd可以参考此文档的 3.3</p><p>官网文档对比：</p><p>egg-mysql： <a href="https://www.eggjs.org/zh-CN/tutorials/mysql#create" target="_blank" rel="noopener noreferrer"><strong>https://www.eggjs.org/zh-CN/tutorials/mysql#create</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>egg-sequelize：<a href="https://www.eggjs.org/zh-CN/tutorials/sequelize" target="_blank" rel="noopener noreferrer"><strong>https://www.eggjs.org/zh-CN/tutorials/sequelize</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="_6-网关" tabindex="-1"><a class="header-anchor" href="#_6-网关" aria-hidden="true">#</a> （6）网关</h2><p>网关：<a href="https://codeup.aliyun.com/5f009f6e6a575d7f23661045/product/backend/gateway" target="_blank" rel="noopener noreferrer"><strong>https://codeup.aliyun.com/5f009f6e6a575d7f23661045/product/backend/gateway</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>接口需要经过网关之后再到服务。请求进入网关后， 网关根据请求模块类型进行分发，分发前会把当前请求的用户信息、企业信息加入请求头，再分发到各个服务。可以在request.header 中获取到相关信息。</p><p>baseController 和 baseService 中已经封装了相应的方法。</p><p><img src="/frontend-md/images/编码规范/image10.png" alt=""></p><p>网关配置：</p><p>在 application-local.yml 中配置对应项目的微服务名， 请求域名。运行服务即可</p><p><img src="/frontend-md/images/编码规范/image11.png" alt=""></p><h2 id="会议录制" tabindex="-1"><a class="header-anchor" href="#会议录制" aria-hidden="true">#</a> 会议录制</h2><p>主题 :nodejs微前端框架介绍</p><p><a href="https://meeting.tencent.com/v2/cloud-record/share?id=304f4fde-de87-44f6-aae0-8fb1c05f2ccb&amp;from=3" target="_blank" rel="noopener noreferrer">录制文件<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/iamouyangdan/frontend-md/edit/main/docs/编码规范/nodejs框架文档.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页"><!--[--><!--]--> 在 GitHub 上编辑此页 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 1183719396@qq.com">ouyangdan</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/ESlint%E8%A7%84%E8%8C%83.html" class="" aria-label="ESlint规范"><!--[--><!--]--> ESlint规范 <!--[--><!--]--></a></span><span class="next"><a href="/frontend-md/%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.html" class="" aria-label="移动端项目结构"><!--[--><!--]--> 移动端项目结构 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/frontend-md/assets/app.050d295a.js" defer></script>
  </body>
</html>
